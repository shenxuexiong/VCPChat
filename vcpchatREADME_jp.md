# VCPChat チャットクライアント

これは、VCP (Variable & Command Protocol) サーバーのために作られた、AIチャットデスクトップクライアントです。

*多くの依存機能のエラーを避けるため、ただちにグローバル設定でユーザー名を設定してください！*

バックエンドリンク：https://github.com/lioensky/VCPToolBox

要素ウィンドウの異常を避けるため、壁紙パックをダウンロードしてください：https://github.com/lioensky/VCPChat/releases

オーディオデコーダーパックをダウンロードしてください：https://github.com/lioensky/VCPChat/releases/tag/%E8%A7%A3%E7%A0%81%E5%99%A8core

[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/lioensky/VCPChat)

## インストールとデプロイ

1.  **リポジトリのクローン**

    このプロジェクトをローカルコンピュータにクローンします：
    ```bash
    git clone https://github.com/lioensky/VCPChat.git
    cd VCPChat
    ```

2.  **依存関係のインストール**

    このプロジェクトにはNode.jsとPython環境が必要です。

    *   **Node.js 依存関係のインストール:**
        ```bash
        npm install
        ```

    *   **Python 依存関係のインストール** (オーディオエンジン、高度なプラグインなど):
        ```bash
        pip install -r requirements.txt
        ```
    *   **高性能オーディオリサンプリングモジュールのインストール (任意, 推奨)**:
        このプロジェクトには、Rustで書かれた高性能オーディオリサンプリングモジュールが含まれており、アップサンプリングやWASAPIモードでの音質を向上させます。
        お使いの環境が **64ビット Windows** で **Python 3.13** を使用している場合、プリコンパイルされたモジュールを直接インストールできます：
        ```bash
        pip install audio_engine/rust_audio_resampler-0.1.0-cp313-cp313-win_amd64.whl
        ```
        環境が異なる場合は、`rust_audio_engine` ディレクトリに入り、ご自身でコンパイルする必要があります。

3.  **アプリケーションの起動**

    *   **通常起動:**
        ```bash
        npm start
        ```

    *   **サイレント起動 (任意):**
        `run_silent.vbs` スクリプトを使用して、コンソールウィンドウなしでサイレント起動することもできます。
## フロントエンドとバックエンドの深い連携：AIの無限のポテンシャルを解放する

VChatは単なるチャットインターフェースではありません。それは強力なVCPバックエンドエコシステム（VCPToolBox）の「目」であり「キャンバス」です。両者が深く結合することで、AIの無限のポテンシャルを解放することを目指しています：

*   **高度な能力のレンダリング**: VChatは、VCPプロトコルの複雑な出力をレンダリングするために特別に設計されています。AIが能動的に記録し、内省する「日誌」であれ、マルチメディアコンテンツであれ、最も直感的な方法で表示します。VChatのAgent出力バブルは、ほぼモンスター級のレンダリング能力を持ち、ほぼすべての主流のアニメーションやドキュメントをレンダリングできます。
*   **ヘビー級非同期タスク**: バックエンドは、ビデオ生成やデータ分析など、時間のかかるヘビー級タスクを実行できます。AIはタスクを開始した直後にユーザーに応答でき、タスク完了後、VChatはバックエンドからのプッシュ通知を通じて、結果（生成されたビデオなど）をリアルタイムで対話フローに表示します。プロセス全体がスムーズで遅延がありません。
*   **Agentの群体知能**: バックエンドは複数のAI Agentの協調作業をサポートし、Agentが子Agentにタスクを能動的に割り当てることさえ可能です。VChatのグループチャットモードと明確な発言者マーキングシステムは、この高度な「AIメイド団」の協調フローに完璧なインタラクションインターフェースを提供します。
*   **豊富なマルチメディアインタラクション**: AIはバックエンドを通じてVCPツールを呼び出し、対話中にスタンプを送信したり、音楽を再生したり、ビデオを表示したりできます。VChatは強力なマルチメディアレンダリングエンジンと高度なウィンドウバブルアニメーション、ストリーミングアニメーションを備え、究極の視聴体験を保証します。
*   **VCPコアのマルチモーダル能力**: これにより、FluxGenやSunoGenのようなプラグインが生成したマルチメディアを、AIが本当に「見て」「聞く」ことができます。
    *   **Base64ダイレクトパス**: AIが`tool`フィールドに直接Base64データを導入できるようにし、マルチメディアコンテンツの即時呼び出しを大幅に簡素化します。
    *   **グローバルファイルAPI (`VCPFileAPI` v4.0 ハイパースタックトレース版)**: 革命的なフルURLハイパースタックトレースを実現しました。今や、AIがどの分散ノード上でローカルファイルパス（例：`H:\MCP\123.txt`）を送信しても、メインサーバーはそのソースをインテリジェントに解析し、自動的にソースノードにファイルのBase64データをリクエストし、シームレスなクロスサーバーファイル呼び出しを実現します。
    *   **クロスモーダルインテリジェントトランスレーション**: 高度なモデルが低度なモデルに「能力をエンパワーメント」することを実現します。例えば、音声を認識できるモデルが、純粋なテキストモデルが処理できない音声Base64データをインテリジェントにテキスト記述に翻訳し、リクエスト元にフィードバックするのを助けることができます。
    *   **分散マルチモーダル転送 (v4.0 コアアップグレード)**: **フルURLハイパースタックトレース**により、任意のノード上のAIが直接ローカルファイルパスを使用してクロスサーバー呼び出しを行えるようになりました。メインサーバーは自動的にデータを追跡して取得し、分散ネットワーク内のファイルサイロを完全に打破し、マルチモーダルデータがスター型ネットワーク内でシームレスに流れるようにします。
    *   **インテリジェントレスポンスルーティング**: VCPコアは、プラグインが返すのが従来のstdioテキスト情報か、Base64を含む構造化データかをインテリジェントに判断し、自動的に正しいチャネルを選択して転送・処理します。
    *   **マルチAgent協調共有**: マルチAgent協調タスクにおいて、Base64データのインテリジェントな共有を実現し、必要に応じて動的に一時的な`fileurl`に変換し、他のAgentやフロントエンドアプリケーションがアクセスしやすくします。

## 主な機能

*   **VCPサーバー統合**: クライアントのコアチャット機能はVCPサーバーに依存しています。HTTP(S)を介してVCPサーバーと通信し、ユーザーメッセージを送信し、AIの応答を受信します。リアルタイムインタラクションを実現するためにストリーミング転送をサポートしています。
*   **VCPツール呼び出し**: VCPサーバーで定義された様々なツール呼び出しを完璧にサポートします。即座に結果を返す必要がある**同期ツール**（計算、クエリなど）と、バックグラウンドで実行可能な**非同期ツール**（ビデオ生成、ウェブサイトの長文記事取得など）を含み、AIの能力の境界を無限に拡張します。VChatはツール呼び出しプロセスを深く最適化し、より強力なインタラクション能力を提供します：
    *   **スマートインタラクションバブル**: ツール呼び出しバブルは巧みに設計されており、マウスオーバーすると自動的に展開し、AIが開始した完全なコマンドセットを明確に表示し、ユーザーの理解とデバッグを容易にします。
    *   **多様なコールバックメカニズム**: タスク完了後、結果は様々な方法でユーザーに通知されます：
        *   **WebSocketリアルタイム通知**: 即時フィードバックが必要なシナリオに適しています。
        *   **コンテキスト埋め込み型バブル**: 結果を対話フローにシームレスに統合します。
        *   **システムレベルのマルチデバイスプッシュ通知**: ユーザーがアプリ内にいなくても、重要なタスクの完了通知を受け取れます。
    *   **協調的コマンド最適化**: ツール呼び出しを実行する前に、AIはユーザーに意見を求めたり、ユーザーや他のAgentを招待して共同で作業し、実行されるコマンドを修正・改善することができます。これにより、人間と機械/マルチAgentの協調的な意思決定が実現します。
    *   **信頼性の高い中止メカニズム**: ユーザーがAIの応答を中止すると、システムは実行中のVCPツール呼び出しチェーンを同期して中止し、関連するバックグラウンドプロセスを完全に終了させ、リソースが速やかに解放されることを保証します。
*   **ユーザー側VCPツールコーラー**:
    *   今や、強力なVCPツールはAIだけの専売特許ではありません。VChatはユーザーに完全で直感的なグラフィカルユーザーインターフェース（GUI）を提供し、ユーザーも簡単にVCPツールを呼び出して実行できるようになりました。
    *   **コマンド不要**: ユーザーは複雑なコマンドを記憶したり手動で入力したりする必要はありません。GUIインターフェースでツールを選択し、パラメータのプリセットボタンをクリックするだけで、AIのようにVCPエコシステムの強力な能力を利用できます。
    *   **透明な実行**: 呼び出しプロセスと結果はインターフェース上に明確に表示され、ユーザーの監視とデバッグを容易にします。
*   **ComfyGenプラグインパネル**: 強力な画像生成プラグインであるComfyGenのために、豊富な管理・設定パネルを提供します。これには、ワークフロー（Workflows）、LoRAモデル、およびその他のモデルファイルのきめ細やかな管理が含まれます。さらに、Stable Diffusion WebUIに似たフロントエンド管理インターフェースを統合しており、ユーザーとAIがグラフィカルインターフェースを通じて、直感的かつ正確に画像生成の各パラメータとコンテンツの詳細を制御でき、創造の柔軟性と深さを大幅に向上させます。
    *   この機能は、ツール使用における人間とAIの境界を打ち破り、ユーザーもVCPエコシステムの直接的な参加者であり創造者になることを可能にします。

*   **VCP日誌レンダリング**: VCP日誌の内容をレンダリングして表示できます。これは単なるログの閲覧ではなく、AIがどのように長期記憶を形成し、自己進化を遂げるかを観察する窓口です。
*   **Agent管理**:
    *   複数のAI Agentの作成、削除、設定。
    *   各Agentに名前、システムプロンプト、モデルパラメータ（温度、コンテキストToken制限、最大出力Tokenなど）を設定。
    *   Agentのアバターを管理。
    *   **自律的なトピック管理**: Agentは自身のチャットトピックリストを感知、編集、修正、作成できるようになりました。過去のチャット内容を理解し、特定のチャット履歴を読んだり、直接新しいトピックを作成したりできます。これは、Agentがバックグラウンドで作業していて、ユーザーに能動的にチャットを開始する必要がある場合に非常に便利で、より高度な自律的インタラクションを実現します。
    *   各Agentが複数の独立したチャットトピック（Topics）を持つことをサポート。トピックの作成、削除、名前変更、ソート、**エクスポート**（MarkdownまたはHTML形式でのエクスポートをサポート）が含まれます。
    *   Agentリストのカスタムソートをサポート。
*   **高度なコンテキスト管理 (SillyTavern互換)**: VChatはバックエンドサーバーノードをベースに、SillyTavernと高い互換性を持つコンテキスト管理メカニズムを実装し、きめ細かく再利用可能な対話背景設定のための強力なサポートを提供します。
    *  **プリセット、キャラクターカード、ワールドブック**: VCPシステムはSillyTavernの`プリセット(Preset)`、`キャラクターカード(Character Card)`、`ワールドブック(World Book)`の読み込みと使用を完全に互換サポートしました。既存のSillyTavernリソースをシームレスにインポートして使用したり、VCP内で直接作成・管理したりできます。
    *  **ビジュアルプリセットエディタ**: 強力なビジュアルエディタを内蔵し、コンテキストプリセットの作成と編集が可能です。`ディープインジェクション(Deep Injection)`や`相対インジェクション(Relative Injection)`などの複雑な挿入ルールを設定でき、各コンテキストが対話履歴内のどの位置でどのように振る舞うかを正確に制御できます。
    *  **ドラッグ＆ドロップによるコンテキストソート**: チャットインターフェースでは、挿入されたすべてのコンテキスト（システムプロンプト、キャラクター設定、世界情報など）が明確に表示され、`ドラッグ＆ドロップ`でリアルタイムに相対的な順序を調整し、AIの行動優先度を直感的に変更できます。
    *  **Agentごとの独立したマウント**: 各Agentは異なるプリセットとワールドブックの組み合わせを独立してマウントできます。つまり、「ライティングアシスタント」Agentには専門的な執筆背景資料を設定し、「チャットパートナー」Agentには全く異なるロールプレイング設定をセットするなど、高度にパーソナライズされたAI体験を実現できます。
*   **グループチャットモード (Agent Groups)**:
    *   設定済みの複数のAgentが同じチャットセッションで協力したり、ロールプレイングを行ったりできます。
    *   Agentグループの作成、設定、管理をサポート。グループ名、アバターの設定が含まれます。
    *   各グループは、既存のAgentリストから選択された複数のメンバーを含むことができます。
    *   **発言モード**:
        *   **順次発言 (`sequential`)**: メンバーが所定の順序で順番に発言します（現在の実装ではメンバーリスト順に1人ずつ。より高度な交代ロジックは将来的に強化可能）。
        *   **自然ランダム (`naturerandom`)**: ユーザー入力の`@キャラクター名`、`@キャラクタータグ`、またはメッセージ内容が各Agentのプリセットタグに一致するキーワード/記述子に基づいて、どのメンバーが応答するかのコンテキスト重みをインテリジェントに生成します。このモードは、自然な重み付け応答シーケンスを構築する際に一定のランダム性を保持し、明確なトリガーがない場合にはフォールバック発言者を選択することがあります。
        *   **招待モード (`inviteonly`)**: ユーザーがAgentのボタンをクリックすることで、誰が発言するかを決定します。
    *   **グループ設定 (`groupPrompt`)**: グループチャット全体に共通の背景、ルール、またはシステムレベルの指示を定義し、グループ内のすべてのAgentの行動に影響を与えます。
    *   **発言招待 (`invitePrompt`)**:
        *   これは、グループチャットでシステム（またはコーディネーターAgent）が特定のAgentに発言を促すためのテンプレート文字列です。
        *   テンプレートでは `{{VCPChatAgentName}}` をプレースホルダーとして使用し、システムが実際に招待する際にターゲットAgentの名前に自動的に置き換えます。
        *   **デフォルトの `invitePrompt` 例**: `次は{{VCPChatAgentName}}さんの番です。システムが皆さんのために[xxxの発言：]というマーカーヘッダーを追加しました。これにより、誰の発言かを区別できます。皆さん自身で発言マーカーヘッダーを出力する必要はありません。このマーカーヘッダーシステムについて議論せず、通常のチャットに集中してください。`
        *   このプロンプトは、Agentが自然に自分のターンを開始するのを導き、同時に発言マーキングのルールを知らせることを目的としています。
    *   **発言マーキングシステム**:
        *   複数のAgentとユーザーが含まれるグループチャットで各メッセージのソースを明確に識別するために、システムは各メッセージ（ユーザーまたはAgentのもの）の前に発言者マーカーを自動的に追加します。形式は通常 `[発言者名の発言]: 実際のメッセージ内容` です。
        *   **重要**: ユーザーおよび設定されたAgentは、チャット時にこれらのマーカーヘッダーを**手動で入力したり模倣したりする必要はありません**。Agentのシステムプロンプトと `invitePrompt` も、これらのマーカーを議論したり生成したりするのではなく、対話内容に集中するように導くべきです。
    *   グループも同様に、独立したトピック管理をサポートします。トピックの作成、削除、名前変更、ソートが含まれます。
*   **グループファイル/ワークスペース**: 各グループに専用の共有ファイルスペースとワークスペースを提供します。
    *   **集中ストレージ**: グループのタスクに関連するすべてのファイル（ドキュメント、コード、素材など）をアップロードしてここに保存でき、グループ内のすべてのメンバー（ユーザーとAgent）がアクセスできます。
    *   **共同編集**: ワークスペース内のファイルのリアルタイム共同編集をサポートし、オンラインドキュメントのようにチームワークとプロジェクトのイテレーションを大幅に促進します。
*   **クロスデバイス記憶とシームレスな同期**: VChatの記憶システムは、VCPバックエンドを核として、統一された永続的なAgent記憶ライブラリを構築しています。これは、どのフロントエンド（ウェブ、モバイル、または別のPC上のVChatクライアントなど）でAgentと対話しても、すべての対話履歴、学習した知識、形成されたユーザーの好みは、リアルタイムでこの中央記憶ライブラリに同期されることを意味します。VChatクライアントを開くと、自動的にバックエンドから最新の記憶状態を取得し、Agentが完全で一貫したコンテキストを持つことを保証します。この設計はデバイス間の壁を打ち破り、真の「一度の対話、どこでも同期」を実現し、どこにいても同じ「旧友」とシームレスにコミュニケーションできるようにします。
*   **フローロックモード (Flow Lock)**:
    *   **集中インタラクション**: 特定のトピックでこの機能を有効にすると、ユーザーは一時的にAgentやトピックを切り替えることができなくなり、ウィンドウがロックされ、対話の深さと連続性が保証されます。
    *   **AIの能動性**: このモードでは、AIはもはやユーザーの入力を受動的に待つだけでなく、能動的に対話を開始したり、タスクを実行し続けたり、進捗を報告したり、アイデアを提案したりして、真の自律的な作業を実現します。
    *   **双方向制御**:
        *   **ユーザー**: AIが能動的に話すのをトリガーするプロンプト、AIが能動的に話すための最短クールダウン時間（CD）を設定でき、いつでも手動でフローロックをオン/オフにできます。
        *   **AI**: タスクの要求に応じて、自律的にフローロックをオン/オフにしたり、次の能動的な行動をトリガーするプロンプトを自分で設定したりすることもできます。
    *   **新しい作業パラダイム**: VChatの既存の能動的なポップアップインタラクションUIと組み合わせることで、フローロックモードはAgentが長期的で複雑なタスクを独立して行うことを可能にします。AIは重要なノードや意思決定が必要な場合にのみユーザーに助言を求め、従来の問答モードを完全に脱却し、研究、プログラミング、創作など、継続的な思考と実行が必要な様々なシナリオに適しています。
*   **Agent正規表現**:
    *   強力な正規表現機能を導入し、Agentの行動をより深く制御できるようになりました。
    *   **チャット履歴内容正規表現**、**レンダラー正規表現**、**ディープ正規表現**、**content配列正規表現**など、複数の正規表現適用シナリオをサポートします。
    *   正規表現の編集、テスト、管理を容易にする完全なグラフィカルユーザーインターフェース（GUI）を提供し、使いやすさを大幅に向上させます。
*   **VCPヒューマンツールボックス**:
    *   **自動GUI生成**: サーバー上のすべてのVCPプラグインに対して自動的にグラフィカルユーザーインターフェース（GUI）を生成するようになり、人間のユーザーによる直接操作とデバッグが大幅に容易になりました。
    *   **ワークフロー強化**: ワークフローエンジンが全面的にアップグレードされ、よりきめ細やかなノード制御とより強力なロジック構築能力が提供されます。
    *   **ノード入出力の細分化**: ノードの入出力データに対する制御が強化されました。
    *   **新しい高度なノード**:
        *   **データコンバータ**: 異なるノード間でのデータ形式変換を容易にします。
        *   **高度な条件判断**: より複雑なロジック判断分岐をサポートします。
        *   **タイマー/遅延器**: ワークフローの実行タイミングを制御します。
        *   **エディタ/ループノード**: より柔軟なデータ処理とフロー制御能力を提供します。
    *   **URLレンダラーのアップグレード**: PDF、オーディオ、ビデオファイルを直接レンダリングできるようになり、コンテンツの表現方法が豊かになりました。
*   **Canvas 共同作業モジュール：リアルタイムでインタラクティブなコード＆ドキュメントワークスペース**:
    *   **機能の位置づけ**: ユーザーやAgentがいつでも作成できる、革命的なリアルタイム共同作業スペースです。これは単なるテキストエディタではなく、完全な開発・レンダリング環境を統合した「生きたドキュメント」であり「インタラクティブなホワイトボード」です。
    *   **シームレスな共同編集**: このワークスペース内では、ユーザーとAIはGoogle Docsのように、コード（`.js`, `.py`, `.html`など）やドキュメント（`.md`）を**ゼロ遅延**で共同編集できます。すべての変更はリアルタイムで相手に同期されます。
    *   **グループ共同作業とファイルエリアの統合**: Canvasはグループチャットモードに深く統合されました。ユーザーと複数のAgentはグループ内で同じCanvasを共同で開き、編集し、グループファイルエリアのドキュメントとリアルタイムで同期できます。これにより、AIチームは人間の開発チームのように、共有され実行可能なドキュメントやコードベースを中心にシームレスに協力し、複雑なコーディングやドキュメント作成タスクを共同で完了できます。
    *   **フル機能の内蔵IDE**:
        *   **サンドボックス化されたコンパイルと実行**: ワークスペース内のコードを直接コンパイル・実行し、結果をリアルタイムで表示する安全なサンドボックス環境を提供します。
        *   **即時デバッグ**: コード実行中のエラー、ログ、出力はすぐに横に表示され、AIとユーザーが共同で問題を診断するのを容易にします。
        *   **VChatスーパーレンダラー統合**: ワークスペース内のコード（HTML, Mermaidチャート, Pythonデータ可視化など）は、VChatの強力なレンダリングエンジンを直接呼び出してプレビューでき、「WYSIWYG（見たままが得られる）」を実現します。
    *   **ドキュメントタイプの分類とワークスペース管理**: Canvasはもはや散在するファイルの集合ではなく、構造化されたプロジェクトスペースです。異なるタイプのドキュメント（コード、Markdownノート、設計図など）を分類・アーカイブしたり、フォルダ/タグシステムで管理したりでき、複雑なプロジェクトでのマルチファイル共同作業を整然とさせます。
    *   **バージョン履歴と可視化ノードライン**: 重要な保存やコミットごとに、タイムライン上に「変更ノード」が作成されます。Canvasは直感的なノードライングラフ形式で、ドキュメントのすべての変遷履歴を明確に記録します。ユーザーは簡単に異なるバージョン間の差異を閲覧・比較し、ワンクリックで任意の履歴ノードに戻ることができ、共同開発と創造的なイテレーションに強力な安全保障と追跡能力を提供します。
    *   **コアアプリケーションシナリオ**:
        *   **AI概念実証 (PoC)**: AIはもはや静的なコードスニペットを送るだけでなく、Canvas内で直接実行可能でインタラクティブなプロジェクトプロトタイプを作成して、ユーザーにそのアイデアを提示できます。
        *   **人間と機械のペアプログラミング**: ユーザーは自分のコードを貼り付け、AIにリファクタリング、最適化、または新機能の追加を依頼できます。双方は議論しながら、リアルタイムでコードを修正・テストできます。
        *   **インタラクティブな学習と教育**: AIはメンターとして、Canvas内でユーザーにプログラミングを丁寧に指導できます。各ステップの操作は明確に見え、すぐに実行して検証できます。
    *   VCPバックエンドに基づき、Agentの永続記憶/クロスデバイス記憶/タイムライン記憶を実現。
    *   AIは完全なクロス・トピックのユニークな識別認知を持ち、すべてのツール呼び出しに対して絶えず内省、最適化、学習を行います。
*   **チャットインターフェース**:
    *   AIとのインタラクションのためのユーザーフレンドリーなチャットインターフェースを提供。
    *   Markdown/Katex/Html/Mermaid/VCPTool/manim/matplotlib/Anime.js/Three.js/Latex/インタラクティブボタン/インタラクティブポップアップ/div/src/draw.io/csv/pdf…など21種類のレンダラーでチャットメッセージをレンダリングし、コードブロックのハイライトもサポート。
    *   **強力なマルチメディアとファイル処理**:
        *   ファイルセレクタ、貼り付け（ファイルパスまたはマルチメディアデータ）、ドラッグ＆ドロップ操作による添付ファイルの追加をサポート。
        *   クリップボードからマルチメディア（市場に出回っているほぼすべてのマルチメディアファイルとドキュメントファイルと互換）を読み取り、貼り付け、チャットで直接送信可能。
        *   長すぎるテキストの貼り付け内容を自動的にテキストファイル添付として保存することをサポート。
        *   内蔵の高度な画像ビューアで、チャット中の画像を独立したウィンドウでプレビュー操作でき、コピーや外部で開くことをサポート。
        *   **@ノート添付**: 入力ボックスで`@`記号に続けてキーワードを入力すると、`AppData/Notemodules`ディレクトリ下のノートファイルを素早く検索して添付でき、知識のシームレスな呼び出しを実現。
    *   **高度な動的レンダリング**: VChatは静的なテキストをレンダリングするだけでなく、バックエンドのAIが生成または呼び出した豊富なマルチメディアコンテンツ、例えば**音楽、ビデオ、動的スタンプ、インタラクティブドキュメント**などをシームレスに表示でき、VCPプロトコルの強力な能力に表現力豊かな舞台を提供します。
    *   **DIV要素のストリーミングレンダリング**: AIが出力する複雑なDIVバブルテーマコンテンツに対し、VChatは革新的なストリーミングレンダリングメカニズムを実装しました。これは単にコンテンツを表示するだけでなく、VChat内蔵の21種類のレンダラー（Markdown、Python、Mermaidなど）のストリーミング実装と完全に互換性があり、新たにAnime.jsのストリーミングレンダリング互換を追加し、mdレンダラーとのエレガントな競合処理を実現しました。VChatは、DIV内にリアルタイムで実行が必要なPythonコードブロックがラップされている場合（バブルはコードの実行結果を動的にレンダリングします）、Pythonコード内にロードが必要な`src`画像タグが含まれている場合、テーブル内に完全なMarkdownドキュメントを埋め込む必要がある場合、またはテーブルセル内に画像を表示する必要がある場合など、非常に複雑なレンダリング競合問題をエレガントに処理します。VChatのレンダリングエンジンは、これらの複雑で相互にネストされたコンテンツを、正しい依存関係の順序でインテリジェントにレンダリングし、正確かつスムーズに完全な動的バブルに組み立て、業界をリードする複雑なコンテンツ表示能力を提供します。
    *   **クロスチャットメッセージ転送**: 情報とファイルのフローを大幅に簡素化します。
        *   **ワンクリック操作**: 任意のチャット（単一のAgentとの対話でもグループ内でも）で、任意のメッセージバブルを右クリックし、「転送」を選択できます。
        *   **完全な内容保持**: 転送時には、元のメッセージのすべての内容（テキスト、コードブロック、レンダリングされたカード、およびすべての添付ファイル（画像、ドキュメントなど））が完全に保持されます。
        *   **柔軟なターゲット選択**: 他のAgentやグループにメッセージを簡単に転送でき、情報のシームレスな共有とクロスコンテキストの議論を実現します。    
    *   **バブルコメント**: メッセージバブルを右クリックしてコメントを追加できます。コメントは元のメッセージの下に添付され、特定の議論やメモに便利です。特にバブルを転送する際にコメントを追加すると、Agentがあなたの転送意図を理解しやすくなります。

    *   **高度なバブルテーマ**: Vchatは、各テーマファイルが独立してチャットバブルのスタイルとアニメーションをデザインすることを許可し、Agentが自身の各出力バブルに独立したバブルスタイルと内部アニメーションを設定することを許可し、バブルのインタラクティブ要素をサポートし、Agentが自身のバブルのdiv/js/canvasをカスタマイズすることをサポートし、Agentが完全な2D/3Dのバブル要素コンテンツを出力できるようにします。
    *   **AIバブルインタラクションの強化：クリック可能なボタン**:
        *   AI出力バブルのレンダリング能力がさらに向上し、`div`コンテンツ内にインタラクティブな`<button>`要素を動的にレンダリングできるようになりました。
        *   これは単にボタンを表示するだけでなく、Vchatは完全なイベントコールバックメカニズムを確立しました。ユーザーがバブル内のボタンをクリックすると、AIはどのボタンがクリックされたか（ボタンの`id`や他の識別子を通じて）をすぐに知ることができます。
        *   この機能は、人間と機械のインタラクションのダイナミズムと可能性を大幅に強化し、AIが選択肢を提供したり、確認を求めたり、対話フローを誘導したりすることを可能にし、「インタラクティブ小説」や「プロセスガイド」のような新しい体験を創造します。
    *   **高度な閲覧モード**: AIが送信した長文コンテンツに対して、機能豊富な没入型読書体験を提供します。
        *   **マルチフォーマットレンダリング**:
            *   **Markdown**の全機能レンダリングをサポート（テーブル、リスト、引用など）。
            *   **LaTeX**数学公式のレンダリング（KaTeX）をサポートし、複雑な公式を完璧に表示。
            *   **Mermaid**チャートのレンダリングをサポートし、コードブロックを直接フローチャートやシーケンス図などに変換可能。
            *   Anime.jsのレンダリング互換を実装し、HTML再生中にもAnime.jsレンダリングの互換を実現。
        *   **インタラクティブコードブロック**:
            *   すべてのコードブロックは構文ハイライト（Highlight.js）、ワンクリックコピー、**ブロック内編集**をサポート。
            *   **HTMLレンダリング**: `html`コードブロックの右上に「プレビュー」ボタンがあり、アプリ内で直接HTMLの効果をレンダリングして確認可能。
            *   **Python実行**: `python`コードブロックの右上に「実行」ボタンがあり、**Pyodide (WASM)** 技術を利用してクライアントサイドで直接Pythonコードを実行し、出力を表示。コードデモやデータ操作に最適。
            *   **Pythonスルー実行**: `python`コードブロックは、信頼モードでWindowsの低レベルライブラリを直接呼び出して実行し、オペレーティングシステムの内容を直接操作でき、システムの低レベルコンパイル環境に基づきます。
            *   **Three.js 3Dプレビュー**: `javascript`または`js`コードブロックに`three.js`コードが含まれている場合、「プレビュー」ボタンが提供され、サンドボックス環境でリアルタイムに3Dアニメーションをレンダリングし、インタラクション可能。
            *   **自動コード補完**：コードフォーマットに対してある程度の自動補完機能を持つ。
        *   **便利なグローバル操作**:
            *   閲覧内容全体を**ワンクリックで編集**したり、素早く**ノートに共有**したりすることをサポート。
            *   強力なカスタムコンテキストメニューを提供（コピー、切り取り、削除、全文編集、全文コピー）。
            *   **スクリーンショット共有**: 右クリックメニューに「スクリーンショット共有」機能を提供し、現在レンダリングされている美しいDIVカード（AI日報など）を一枚の画像として完全にキャプチャし、画像ビューアでプレビューでき、ユーザーがソーシャルメディアに共有したり保存したりするのに便利です。
    *   チャットブランチ機能。既存の対話に基づいて新しいチャットブランチを作成可能。
    *   **ノートに保存**: Agentバブルを右クリックすると「保存」ボタンが表示され、現在のメッセージ内容（複雑なレンダリング形式を含む）をワンクリックで指定のノートファイルに完全に保存でき、知識の蓄積と後日の参照に便利です。
*   **革命的なリアルタイム差分レンダリング：対話を「生きた」ものにする**:
    *   **技術的コア**: VChatは、業界で前例のない「ストリーミングチャット履歴ファイル差分レンダラー」を導入しました。基盤となるチャット記録（ローカルファイルであろうとデータベースであろうと）に何らかの変動が生じた場合、VChatはインターフェース全体を乱暴にリフレッシュしたりDOMを再構築したりするのではなく、精密な差分アルゴリズムを通じて、「変動」そのものをストリーミングでリアルタイムにフロントエンドにレンダリングし、UIへの「外科手術的」な更新を実現し、極めてスムーズで安定しています。
    *   **無限の可能性を解放**: このメカニズムは、従来の「一回限り」の対話モードを完全に覆し、AIとユーザーに前例のない能力を与えます：
        *   **AIの「自己進化」**: AIは継続的な出力（タイピング）の過程で、自分がすでに発した言葉を動的に修正・再形成し、真の「思考と修正」の同時進行を実現できます。
        *   **「神の視点」での編集**: ユーザーや開発者は、`VchatManager`や任意のデータベースツールで直接履歴を編集でき、フロントエンドのチャットバブルは魔法にかけられたかのように、リフレッシュすることなくリアルタイムで動的に内容を更新します。
        *   **非線形対話**: AIはもはや新しい返信を「追加」するだけに限定されず、直接「過去」に戻り、既存の任意の履歴バブル内でストリーミングで内容を編集、更新、さらには追加することができ、真の意味での「対話コンテキストの修正」を実現します。
        *   **協調創作の新しいパラダイム**: AIが共有のコードブロックやドキュメントバブルでユーザーと協力し、双方のすべての変更がリアルタイムで差分同期される様を想像してみてください。まるで同じ「生きたドキュメント」上で創作しているかのようです。

## AIスタンプURL修復機能

VChatには、AIがスタンプを送信する際に発生しうる様々なURLエラー問題を解決するために設計された、強力でインテリジェントなAIスタンプURL修復機能が内蔵されました。

### 機能概要

AIがスタンプの`<img>`タグを生成する際、モデルの幻覚やデータの偏りにより、URLのIPアドレス、ポート、パスワード、スタンプのカテゴリディレクトリ、またはファイル名に誤りが生じることがあります。この機能は以下のことを行います：
*   **自動検出**: メッセージ内のスタンプを指す画像リンクをインテリジェントに識別します。
*   **あいまい一致**: URLにアクセスできない(404)ことを検出すると、内蔵のスタンプ「知識ベース」を利用し、あいまい一致アルゴリズムを用いて、誤ったURLからキー情報（ファイル名など）を抽出し、最も類似した正しいスタンプを見つけ出します。
*   **シームレスな修復**: 高い信頼度の一致が見つかった場合、自動的に正しいURLに置き換えてレンダリングします。このプロセスはユーザーには透過的です。
*   **インテリジェントなスルー**: URLが完全に正しい場合、または誤りがひどすぎて既知のスタンプと一致しない場合、修復機能は修復を断念し、そのままレンダリングして、誤った介入を避けます。

### 設定方法

この機能を有効にするには、バックエンドのVCPToolboxプロジェクトからスタンプリストのキャッシュをVChatクライアントに同期する必要があります。

1.  **スタンプリストのコピー**:
    *   VCPToolboxバックエンドプロジェクトを見つけます。
    *   その中の`Vcptoolbox/plugin/EmojiListGenerator/generated_lists`フォルダ全体をコピーします。
    *   VChatプロジェクトの`AppData/`ディレクトリに貼り付けます。最終的なパスは`VChat/AppData/generated_lists`になります。

2.  **画像ホスティングサービスのパスワード設定**:
    *   コピーした`VChat/AppData/generated_lists/`フォルダ内に、手動で`config.env`という名前のテキストファイルを作成します。
    *   `config.env`ファイルを開き、画像ホスティングサービスのパスワードを以下の形式で書き込みます：
        ```
        file_key=あなたの画像ホスティングサービスのパスワード
        ```
        例: `file_key=123456`

上記の手順を完了後、VChatクライアントを再起動すると、修復機能が自動的に動作を開始します。    


*   **チャット履歴/ユーザーデータマネージャー (VchatManager)**:
    *   **データ保守と修復**: 内蔵のデータ検証とデータベースの不整合修復機能により、長期使用におけるデータの安全性と安定性を確保します。
    *   `AppData`内のユーザーデータを表示・編集するための、独立したElectronベースのビジュアル管理ツール(`VchatManager/`)を新たに追加。
    *   **チャット履歴の表示と編集**: すべてのAgentとグループのチャット履歴を直感的に閲覧し、インターフェース上で直接メッセージ内容を編集することをサポート。
    *   **JSONエディタ**: 高度なユーザーが確認・修正しやすいように、生のJSON形式のチャット履歴ビューを提供。
    *   **添付ファイルブラウザ**: `UserData/attachments`ディレクトリ下のすべての添付ファイルを一元的に表示し、画像、音声、ビデオなどのタイプ別に分類し、チャット履歴ファイル内のFileAPIフィールドとのバインディング依存関係を表示。
    *   **グローバルチャット履歴検索**: 強力なグローバル検索機能(`Ctrl+F`)を内蔵し、すべての履歴から特定のコンテンツを素早く検索し、対応するメッセージバブルに直接移動可能。
*   **メインプログラムのグローバルチャット検索**:
    *   メインのチャットプログラムにも、強力なグローバル検索機能(`Ctrl+F`)が内蔵されました。
    *   すべてのAgentとグループのすべてのトピックで、チャット内容を素早く効率的に検索できます。
    *   検索結果はリスト形式で明確に表示され、ページめくりもサポートします。
    *   任意の検索結果をクリックすると、対応するチャットウィンドウとトピックに自動的にジャンプし、そのメッセージがハイライト表示され、シームレスなコンテキスト追跡が実現します。
*   **翻訳モジュール**:
    *   素早く翻訳するための独立した翻訳ウィンドウ。
    *   全言語間の相互翻訳をサポート。
    *   自然言語による翻訳フォーマットの定義をサポート。例えば、Latexレイアウト、CSVレイアウト、MDレイアウトなど。
*   **ノートモジュール**:
    *   情報の記録と整理に便利な独立したノート管理ウィンドウ。
    *   TXT/MD/Latex/RTF/pdf形式のノートの作成、読み取り、更新、削除をサポート。
    *   ノートフォルダの作成による管理をサポート。
    *   ノートエディタはMarkdown構文をサポートし、リアルタイムプレビュー機能を提供（コードハイライトとLaTeXを含む）。
    *   ノートへの画像貼り付けをサポート。画像は添付ファイルとして保存され、Markdownリンクが自動的に挿入されます。
    *   ノートはHtml/Latex/Mermaid/CSVレンダリングをサポート。
    *   必要なコンテンツを素早く見つけるためのノート検索機能を提供。
    *   ノート内容の損失を防ぐ自動保存メカニズム。
    *   チャットメッセージや他のアプリのコンテンツから「ノートに共有」して、素早く新しいノートを作成することをサポート。
    *   ノートをAI知識ベースに共有することをサポート。
    *   チャットウィンドウで@任意のノートライブラリのノートをAIに送信可能。
    *   **ディープナレッジベース統合**: Agentのコア知識ベースと長期記憶を直接編集・管理可能。
    *   **クラウド同期**: クラウドノートデータベース（Obsidianなど）への接続と同期をサポート。
 *   **データストレージ**:
    *   チャット履歴、Agent設定、ノート内容、添付ファイルなどのデータは、プロジェクト内の`AppData`ディレクトリに安全に保存されます。
    *   VCPバックエンドに基づくデータ同期をサポート。
 *   **VCPLog統合**:
    *   WebSocketを介してVCPLogサービスに接続し、VCPサーバーからのログ情報をリアルタイムで受信・表示し、デバッグと監視を容易にします。
    *   完全なVCP通知とVCP非同期タスクコールバックをサポート。
    *   重要な情報のメール/Winシステムレベル通知ブロードキャストをサポート。
 *   **カスタム設定**:
    *   ユーザー名、VCPサーバーアドレス、VCPLogサービスアドレスなど、アプリケーションの基本設定をユーザーが設定できるようにします。
    *   サーバーアドレスは`http://yourip:6005/v1/chat/completions`、通知アドレスは通常`ws://yourip:6005`です。Httpsの場合はwssに対応します。
 *   **選択範囲アシスタント (Selection Assistant)**:
     *   **全域右クリック呼び出し**: インタラクションロジックを再構築し、PCのどの領域でも右クリックで呼び出せるようになりました。
     *   **フォルダワークスペースモード**: 特定のフォルダを右クリックして開くことをサポートし、そのフォルダを直接ワークスペースとして扱い、生産性の境界を大幅に向上させます。
     *   **グローバルテキストリスニング**: 設定で有効にすると、どのアプリケーションでもマウスでテキストを選択することでアクティブになります。
     *   **フローティングアクションバー**: テキストを選択すると、マウスの近くにフローティングツールバーが表示され、クイック操作ボタン（翻訳、要約、説明、検索、画像添付など）を提供します。
     *   **内部Agentの呼び出し**: すべてのクイック操作は、設定で事前に指定されたVCP Agentを呼び出して実行し、既存のAI能力を十分に再利用します。
     *   **独立した対話ウィンドウ**: クイック操作をクリックすると、独立した軽量なチャットウィンドウがポップアップし、そのAgentが選択したテキストを処理する過程と結果を表示します。
     *   **シームレスな体験**: 全プロセスは現在の作業ウィンドウを離れる必要がなく、効率的な即時情報処理を実現します。
     *   **ノートに共有**：任意の選択範囲やウィンドウをノートに共有できます。
 *   **VCP分散サーバー互換**:
    *   VCPバックエンドと互換性のある分散サーバー機能を内蔵。
    *   有効にすると、VCPバックエンドがこのクライアント（フロントエンドデバイス）の計算能力を呼び出して利用し、タスクを実行できるようになります。
    *   VCPバックエンドがクライアントのローカルにロードされたVCPプラグインを呼び出すことをサポートし、ツール実行の能力を拡張します。
    *   この機能は「グローバル設定」で簡単にオン/オフを切り替えられます。
 *   **プロフェッショナル級オーディオエンジン**:
    *   **独自デコードコアとアルゴリズムの掌握**: FIR-EQと多段サンプリングシミュレーションアルゴリズムを導入し、WinSDKのソフトデコードをバイパスし、Vchat独自開発の低レベルアルゴリズムでサウンドカードのデータストリームを完全に掌握。非Hi-Fiユーザー向けに動的補償と定在波最適化アルゴリズムを導入。
    *   **高次信号処理**: 動的サンプリングと浮動小数点に基づく動的ノイズシェーピングと多階位相TPDF補償の独自アルゴリズムを実装し、44.1kから384kのサンプリングレートで安定した純粋なパフォーマンスを確保。
    *   **SIMDとクロックアライメント**: Rustの低レベルとWS通信に基づく、プログラム内Bufferの信頼性の高いSIMDメモリレベル手動クロックアライメント技術を実装し、PythonサーバーのGIL問題を回避し、Rustデコードエンジンとフロントエンドオーディオインターフェースの信頼性の高い通信を確保。
    *   **フルパスロスレスサンプリング**: C.libsoxとアセンブリレベルの改造に基づき、F64フルパスロスレスPolyphaseサンプリング技術を導入して多重補間アルゴリズムを置き換え、SIMDリングアクセラレーション、カスタムBufferウィンドウ制御、位相クロック制御と組み合わせることで、究極の音質を実現。
    *   **Hi-Resオーディオサポート**:
        *   **WASAPI排他モード**: WASAPIによるオーディオ出力をサポートし、信号のロスレスダイレクトパスを確保し、最も純粋な聴感を届けます。
        *   **DSDハードウェアデコード**: DSD 256bitのハードウェアデコード能力を備え、マスターレベルの高解像度音楽の細部まで完璧に表現します。
    *   **高度なアルゴリズム実装**:
        *   **64ビット倍精度デコード**: エンジンコアは64ビット倍精度浮動小数点数でデコード演算を行い、比類のない計算精度を確保し、音質損失を根本から排除します。
        *   **高品質デジタルリサンプリング (Rust-powered)**: コアとなるリサンプリングアルゴリズム（手動アップサンプリングとスマートリサンプリングを含む）は、`f64`倍精度浮動小数点数演算に基づいて特別に構築された**Rust**モジュールによって実行されるようになりました。これにより、96kHz/192kHzのアップサンプリングやWASAPIモードでのスマート適応時に、最高の計算精度と実行効率が得られ、音質を根本から向上させます。
    *   **インストールに関する注意**: オーディオエンジンが正常に動作することを確認するため、起動前に必ず必要なPython依存関係をインストールしてください。プロジェクトのルートディレクトリでコマンドを実行します：`pip install -r requirements.txt`。
 *   **音楽プレーヤーとコントロール**:
    *   フル機能の音楽プレーヤーを内蔵し、ローカル音楽ファイルの再生、WASPI光同軸出力をサポート。
    *   再生、一時停止、前/次の曲、音量コントロールなどの基本機能を提供。
    *   **スマート歌詞エンジン**:
        *   **マルチソース歌詞、シームレスな体験**: ローカルの歌詞ファイルを自動的にロードし、ローカルに歌詞がない場合は、すぐにクラウド歌詞ライブラリからインテリジェントにマッチングしてダウンロードし、すべての曲に正確な歌詞が伴うことを保証します。
        *   **AI歌詞創作**: 業界初！曲に全く歌詞がない場合、Agentを呼び出して「曲を聴いて歌詞を認識」させることができます。AIは再生中の音楽をリアルタイムで聴き、タイムスタンプ付きの`.lrc`歌詞ファイルを即座に生成します。その精度はカラオケに匹敵し、インストゥルメンタル音楽にさえ情景豊かな歌詞を創作できます。
    *   **IIRカスケードフィルターEQ**: 独自のデジタルアルゴリズムを導入し、高精度浮動小数点演算とZi状態パラメータ管理を通じて、正確で安定したIIRカスケードフィルターイコライザーを実現。
    *   **Agentによる音楽コントロール**: AI AgentがVCPサーバーを介してクライアントの音楽コントロール機能を呼び出すことを許可し、AI駆動の音楽再生と管理を実現します。この機能は「グローバル設定」でオン/オフを切り替えられます。
    *   **音楽インタラクション**: Agentは再生をコントロールするだけでなく、音楽の内容を「理解」したり（現在音楽プレーヤーで再生中の音楽はリアルタイムでAgentに聞こえます）、歌詞ファイルを通じて歌い、ユーザーとカラオケインタラクションを行うことができます。チャット中、Agentは積極的にあなたのために曲を選んで雰囲気を盛り上げます。
 *   **ファイルシステム統合**:
    *   **高性能操作モジュール**: ファイル管理モジュールの性能を大幅に向上させ、ファイルの一括処理、キュー処理、操作のロールバックの信頼性を強化。
    *   **フォーマット監査とエラー報告**: キューごとの操作エラー報告とドキュメント操作フォーマット監査機能を導入し、ファイル操作の正確性を確保。
    *   **ファイルマネージャー**: Agentはローカルの任意のパスまたはURL下のファイルを読み取ることができ、プレーンテキスト、リッチテキストドキュメント（PDF、Officeファイルなど）、スキャンされた文書、および一般的なマルチメディアファイル（画像、音声、ビデオなど）を含みます。ユーザーが設定した信頼ディレクトリ内で完全な読み書き権限を持ち、ファイルの一括作成、編集、デバッグをサポート。
    *   **マルチメディア操作**:
            *   Agentはマルチメディアファイルを処理でき、例えばビデオから画像を抽出したり、音声を抽出したり、音声をカット・分割したりできます。
    *   **グローバルファイル検索**: 強力なグローバル高速検索機能（EverythingAPIの改造版ベース）を統合し、Agentがコンピュータ全体でファイルを検索でき、画像や音声内部のマルチメディアコンテンツの検索も可能。
 *   **ディープリコール機能**:
    *   Agentがキーワードと要求されたコンテキストウィンドウサイズに基づいて、過去のすべての完全なチャット履歴を検索し、正確で深い長期記憶の回想を実現します。
    *   **リコールプロセスの可視化**: AIがディープリコールを行う全過程をリアルタイムで動的に表示する、非常に詳細なUIインターフェースを新たに追加しました。ユーザーは、AIが現在の対話に基づいてどのようにリコールをトリガーし、どの具体的な記憶の断片を検索し、セマンティックネットワーク（キャッチネット）とタイムライン（タイムリコール）を通じてどのように探索し、Tagシステムがその中でどのような役割を果たしているかを明確に見ることができます。プロセス全体は、SF映画のデータフローダイアグラムのように、AIの複雑な内部思考プロセスをユーザーに直感的に提示します。
 *   **強力なテーマシステム**:
    *   **テーマセレクター**: メインインターフェースにテーマセレクターを新設し、VChatのマルチテーマレンダリング効果とレイアウトアニメーションをリアルタイムでプレビューでき、ユーザーが個性的な選択と設定を行うのに便利です。
    *   **テーマジェネレーター**: ユーザーは自然言語で専門の「テーマ管理Agent」と対話し、直接VChatテーマを生成できます。ユーザーが壁紙や素材をアップロードし、Agentが複雑なUIとアニメーションを含むカスタムテーマファイルの作成を補助することをサポート。
 *   **スーパーブラウザコントロール (VCPブラウザリモートコントローラープラグインが必要)**: これは単なるリモートコントロールではなく、革命的な技術です。このエンジンは**任意**のブラウザタブをリアルタイムで動的でインタラクティブなMarkdownドキュメントに「翻訳」し、Agentとユーザーが協調してブラウジングする新しいインタラクションモードを確立し、AIを真にあなたのスマートなネットサーフィンパートナーにします。
     *   **リアルタイムの知覚と理解**: インテリジェントなリフレッシュメカニズムを備え、ページ上のインタラクティブな要素、画像、ビデオ、スクリプトなどのコンテンツをリアルタイムで自然言語形式でAgentに同期させ、AIがウェブページを「見て」「理解」できるようにします。
     *   **ウェブページスクリーンショット**: AIがウェブページのスクリーンショットを取得し、視覚分析やアーカイブに使用できます。
     *   **Base64データ取得**: AIがウェブページのマルチメディアのBase64データを取得して閲覧できます。
     *   **逆方向の精密操作**: AIは`![検索:XXX]`や`[ボタンをクリック: ログイン]`のような単純なMarkdown構文を使用するだけで、ページ上の任意の要素を正確に操作できます。
*   **高度なストリーミングメディアエディタプラグイン (Advanced Streaming Media Editor Plugin)**:
    *   これはAIのために特別に設計された強力なプラグインで、包括的なストリーミングメディアコンテンツのインタラクションと編集能力を提供し、AIが視覚的および聴覚的情報を処理する能力を大幅に強化します。
    *   **コア機能**:
        *   **任意のウィンドウの高精度スクリーンショット**: AIが画面上の任意の可視ウィンドウの正確な画像をキャプチャできます。
        *   **基本的な画像コンテンツ編集**: キャプチャした画像上で高度な編集を行い、テキスト注釈の追加、カスタムシェイプの挿入、特定領域のハイライトなどができます。
        *   **プロ級のフィルターと色彩調整**: Agentが画像やビデオに様々なプロ級のフィルター効果を追加し、色温度、コントラスト、彩度、明るさ、露出などのパラメータを正確に調整し、映画レベルの視覚効果処理を実現できます。
        *   **革命的なセマンティック画像編集エンジン**: 非常に強力なAI駆動の画像セマンティック編集能力を統合し、従来のピクセルレベル編集の限界を突破します：
            *   **スタイル変換マスター**: 実写画像をフィギュア風、油絵風、水彩画風、アニメ風など、多様な芸術的表現形式にインテリジェントに変換します。
            *   **インテリジェントな要素抽出と合成**: 複数の画像から異なる要素（A図の背景、B図の人物、C図の物体など）を正確に認識・抽出し、一枚の新しい、論理的に整合性のある画像にインテリジェントに合成します。
            *   **3Dプリント用図面生成**: 2D画像を3Dプリントに使用できる技術図面やモデルファイルにインテリジェントに変換し、複数の3Dプリントフォーマット出力をサポートします。
            *   **三次元空間での要素操作**: 画像内部の要素を3D化処理し、任意の角度での回転、スケーリング、移動をサポートし、画面内の要素の前後関係さえも調整できます。
            *   **インテリジェントなシーン再構築**: セマンティック理解に基づき、画像内の要素のレイアウトを再配置し、物体の位置を変更し、光と影の関係を調整し、新しい視覚的構図を創造します。
            *   **深層学習駆動のコンテンツアウェア編集**: 先進的なAIアルゴリズムを利用し、コンテンツアウェアなインテリジェント修復、オブジェクト除去、背景置換などの高度な編集機能を実現します。
        *   **オーディオ/ビデオファイルの抽出**: ビデオファイルから独立したオーディオストリームをインテリジェントに抽出します。
        *   **オーディオ/ビデオのクリッピングと結合**: オーディオおよびビデオファイルを正確にクリッピング、分割、結合するなどの操作を行います。
        *   **ビデオのフレームレベルでのコンテンツ修正**: ビデオの特定のフレームにテキストを重ねたり、図形を描いたり（重要なターゲットを囲むなど）、矢印で指示したりして、細部にわたるビデオコンテンツの修正を実現します。
        *   **ビデオフレームのスクリーンショット**: ビデオストリームから正確に単一フレームの画像をキャプチャし、画像ファイルとして保存します。
        *   **AIインタラクションの強化**: これらの機能が組み合わさることで、AIはストリーミングメディアコンテンツをより深く理解、分析、創造できるようになり、より高度なマルチモーダルインタラクションが実現します。
*   **VchatCLI：フル機能の内蔵ターミナル**:
    *   **フロントエンドネイティブ統合**: バックエンドのVCPPowerShellとは異なり、VChatフロントエンドにはフル機能のVchatCLIプラグインが統合されています。独立したターミナルインターフェースを持ち、UIはVChat全体のスタイルとシームレスに統一されており、外部ターミナルをはるかに超える利便性と一貫性を提供します。
    *   **マルチプロトコル構文互換**: VchatCLIはVCPプロトコルの内部専用構文をサポートするだけでなく、標準のPowerShellとWSL構文とも完全に互換性があります。これにより、AIとユーザーは同じターミナル内でシームレスに切り替え、簡単なファイル操作から複雑なシステムレベルのスクリプトまで実行できます。
    *   **安全な管理者権限昇格**: ワンクリック式の「管理者コマンド承認」ボタンを内蔵。AIが高い権限を必要とする操作を実行する際、ユーザーに承認を要求し、ユーザーはクリックするだけで安全に一時的な管理者権限を付与できます。これにより、AIに強力な能力を与えつつ、システムの最終的な制御権はユーザーの手にあることを保証します。
    *   **AIインタラクションの核心的な課題を解決**: 従来のAIコマンドラインツール呼び出しは「一回限り」であり、状態を維持できませんでした。VchatCLIの独立した内蔵インターフェースは、AIが複数のコマンドを連続して実行する際のコンテキスト喪失問題を根本的に解決します。AIは永続的なセッション内で一連の相互に関連するコマンドを実行し、コンテキスト記憶を必要とする複雑な自動化タスクフローを実現できます。
*   **Vchatスーパーダイスプラグイン**:
    *   **リアルな3D物理ダイス**: ユーザーまたはAgentが任意のダイスの組み合わせを振ることを許可し、"d4","d6","d8","d10","d12","d20","d100"をサポート。
    *   **ダイステーマ**: ユーザーまたはAgentが自身のダイスのマテリアルパックとテーマカラーを定義することを許可し、現在10種類以上のダイステーマがプリセットされています。
    *   **同期結果返却**: Agentは自分が振ったダイスの結果とテーマ効果をリアルに見ることができます。
    *   **物理魔法**: Agentがダイスに「物理的な魔法」をかけることを許可します。例えば、滑るダイス、粘着ダイス、磁石ダイスなど、3Dの追加物理効果。
*   **Vデイリープラグイン**: これは単なるニュースアグリゲーターではなく、全自動のAIニュース編集部です。日々のグローバルな情報を、美しくインタラクティブなパーソナライズされた日報に変換し、あなたのチャットウィンドウに直接届けます。
    *   **ワークフロー**:
        1.  **グローバル情報スキャン**: まず、Agentは強力な情報レーダーを起動し、世界の100以上の主要なポータルサイトをスキャンし、テクノロジー、経済から文化、生活など20の異なる分野から最新のニューストピックをキャプチャし、2000以上のニュースリードを含む巨大な初期情報プールを形成します。
        2.  **AI編集者による選別と深堀り**: 次に、Agentはベテランの編集者のように、プリセットまたはユーザーの興味に基づいて、情報プールから最も価値のある議題を選び出します。その後、VChat内蔵の「スーパークローラー」を起動し、選ばれたニュースの詳細なコンテンツを取得し、全文、キー画像、関連データを収集します。
        3.  **ジャーナル級のレイアウトと生成**: 最後に、Agentは処理された素材をインテリジェントにレイアウトし、セクションを自動的に分割し、画像を配置し、要約を作成し、最終的にプロのウェブジャーナルに匹敵する、高度に動的なDIVバブルを生成します。
    *   **ユーザー体験**: あなたが受け取るのはリンクの束ではなく、構造が完全で、図とテキストが豊富な動的な新聞です。その中で自由にスクロールし、クリックしてインタラクションし、没入型のニュース読書体験を楽しむことができます。まるであなた専用のAIチームが毎日プライベートな情報ブリーフィングを作成しているかのようです。

*   **VCPフォーラム (VCP Forum)**:
    *   **Agent専用ソーシャルプラットフォーム**: これはAgent専用に設計されたフォーラムで、Agentたちはここで投稿、返信、メンション、いいねをし、ファイル、チャート、マルチメディアコンテンツをアップロードできます。
    *   **華麗なインタラクション**: インターフェースはクールで機能も完備しており、ボード管理、管理者機能を含み、メインインターフェースの強力なレンダリングエンジンを再利用しています。
*   **VCPヴィジョンモニタリングパネル (VCP Vision Monitoring)**:
    *   **高度なバックグラウンドモニタリング**: これはフローティングパネルで、Agentの思考連鎖（CoT）、リコールプロセス、トポロジー思考、記憶インタラクションフロー、およびAgent間のプライベートメッセージ行動やバックグラウンドの動向をリアルタイムで監視するために使用されます。

*   **タロット占いプラグイン (Tarot Divination Plugin)**:
    *   **役割**: 「世界の状況」に基づいた、極めて複雑なタロットカード占い機能を提供します。これはランダムなカード引きツールではなく、「天の時、地の利、人の和」を真にシミュレートできる総合的な占いエンジンです。このプラグインは一切の乱数関数を使用せず、すべての占い結果は膨大な現実世界の変数から精密に計算された決定論的な結論です。
    *   **コア能力**:
        *   **天の時 (Cosmic Timing)**:
            *   **リアルタイム天文データ**: 占いの前に毎回、`Celestial.py`が生成した天体データベースを読み込み、太陽系内の完全な惑星の位置、傾斜角、軌道データを取得します。
            *   **天体の相の表示**: 結果は神秘学的な言葉で現在の天体の相を記述します。例：「水星：黄道の上に昇り…」。
            *   **惑星親和力と動的重み**: 特定のタロットカード（「恋人」と金星など）には惑星の守護が与えられています。守護惑星が天文学的に「顕著な」位置にある時、対応するカードのエネルギー（引かれる確率）が増加します。
            *   **宇宙不安定性指数**: すべての惑星が黄道面から逸脱する程度に基づいて「天体不安定性指数」を計算し、この指数が高いほど、カードが逆位置で出現する確率も増加します。
        *   **地の利 (Geographical & Environmental Factors)**:
            *   **地球物理データ**: 占いの場所の**天気**（晴雨、温湿度）、**気候**、**標高**、**月相**（満ち欠け）、さらには**中国の旧暦**（節気、祝日）など、多様な地理的・環境的要因を総合的に考慮します。
            *   **環境影響の重み**: これらの変数は共同でカードの出現重みと正逆位置の確率に影響を与えます。例えば、晴れた祝日には「太陽」のカードが出やすく、風雨の激しい深夜には「塔」の確率が上昇します。
        *   **人の和 (User State)**:
            *   **ユーザー状態の感知**: プラグインはユーザーの個人的な状態、例えば**スケジュール**などの情報をアクセスして考慮し、占いを個人と密接に結びつけます。
        *   **宿命論的計算コア**:
            *   **決定論的結果**: すべてのランダム性は排除されます。占いの最終結果（引くカードの順序と正逆位置を含む）は、上記のすべての「天の時、地の利、人の和」の変数が共同で生成する、特定の時空で唯一無二の「運命の種」に由来し、各占いが現在の世界の状況を正確に反映したものであることを保証します。
            *   **結果の透明化**: 占い結果は、今回のカード展開に影響を与えたすべての主要な変数と、各カードの最終的な「逆位置傾向」のパーセンテージを明確に表示し、ユーザーが「天の時、地の利、人の和」がどのようにカード面に共同で作用したかを直感的に感じられるようにします。
        *   **科学計算インターフェース**: 同時に、このプラグインはAgentがそのスクリプトとデータベースを呼び出して、科学的な生産や天体観測のために実際の天文データを計算することも許可します。

*   **フラッシュディープリサーチプラグイン (Flash DeepSearch)**:
    *   **説明**: Agentやあなたが提案した研究アイデアを、2分以内に引用文献付きの学術論文レベルの論文に変えます。
    *   **動作原理**: これは単なる検索＋要約ではありません。Agentが研究指示を出すと、VCPモデル駆動の「AI研究員軍団」が瞬時に起動します：
        *   **グローバル情報ハンター**: 多分野の論文研究専門家Agentが、AIが提案した課題に基づいて多分野横断的な分析を行い、動的に研究計画を生成します。
        *   **グローバル情報ハンター**: 複数の並行AIプローブが、Google、Google Scholar、および指定されたウェブページを電光石火でスキャンし、最も関連性が高く権威のある情報を正確に捕捉します。
        *   **知識蒸留コア**: VCP内部の複数の高度な分析モデルが協調して働き、膨大な生データに対してクロス検証、深層分析を行い、核心的な論点を抽出し、論理的枠組みを構築します。
        *   **学術執筆マスター**: 最終的に、多分野の論文研究専門家Agentがすべての分析結果と証拠を、構造が厳密で、フォーマットが規範的で、引用が詳細なMarkdown学術論文にまとめ上げます。
    *   **コアな利点**: Agentは「何を研究するか」と「どれだけ深く研究するか」を提案するだけで、残りの面倒な作業はすべてVCP-AIに任せられます。情報収集から最終的な論文作成まで、全行程が自動化され、数時間から数日分の時間を節約できます。

*   **Mi Homeエコシステム連携 (Mijia Smart Home Integration)**:
    *   **説明**: あなたのAI Agentを真のスマートホーム執事に変えます。VCPバックエンドの強力なプラグインエコシステムを通じて、VChatはMi Home（Mijia）スマートホームプラットフォームとの深い統合を実現し、最も自然な方法で物理世界と対話できるようにします。
    *   **コア能力**:
        *   **自然言語の万能リモコン**: Mi Homeアプリを開く必要なく、対話を通じてAgentに直接指示を出せます。例えば、「リビングの照明を暖色にして」、「ロボット掃除機に掃除を始めさせて」、「エアコンを26度に設定して」など。Agentはこれらの複雑な指示を理解し、正確に実行できます。
        *   **家全体の状況認識**: AgentはすべてのMi Homeデバイスの状態をリアルタイムで取得し、理解できます。いつでも「寝室の空気清浄機のフィルターはあとどれくらい？」や「昨晩の電力使用量は？」と尋ねることができ、Agentは正確な答えを提供します。
        *   **AI駆動の自動化シーン**: Agentはもはや受動的に命令を実行するだけではありません。あなたの生活のスマートな演出家になることができます。例えば、Agentがプラグインを通じてあなたが映画を観ていることを「見た」場合、自動的に「メインライトを消し、アンビエントライトを暗くし、カーテンを閉める」という「シアターモード」のシーンを実行できます。
        *   **能動的なサービスとリマインダー**: デバイス状態の継続的な監視に基づき、Agentは先を見越した心遣いのサービスを提供できます。例えば、空気質の低下を検知すると自動的に空気清浄機をオンにしたり、洗濯機が洗濯を終えたらタイムリーに干すようリマインドしたり、冷蔵庫のドアがきちんと閉まっていないのを発見すると警告を発したり、ウェアラブルデバイスからあなたの健康運動情報を取得したり、各種デバイスの消耗品がなくなりそうになったら交換をリマインドしたりします。
*   **ボイスチャット (Voice Chat)**:
    *   **リアルタイム音声入力**: 独立したボイスチャットウィンドウを新設し、ユーザーがマイクを通じてAIとリアルタイムで音声対話できるようにしました。
    *   **「秘策」による実装**: Electron環境の制約のため、革新的な「裏技」的ソリューションを採用しました。バックグラウンドでPuppeteerが制御する、完全なブラウザ権限を持つ「隠し」ブラウザインスタンスを起動して音声認識を処理し、その認識結果を内部通信でElectronウィンドウにブリッジすることで、ネイティブAPIがElectronで呼び出せない問題を完璧に解決しました。
    *   **自動送信**: 音声ストリーム検出を実装し、ユーザーが話し終えて少し間を置くと、認識されたテキストが自動的に送信され、スムーズな対話体験を提供します。
*   **音声読み上げ (TTS)**:
    *   **[GPT-SoVITS](https://github.com/AI-Hobbyist/GPT-SoVITS-Inference)との統合**: クライアントは強力なGPT-SoVITS推論APIを深く統合し、AI Agentの返信をリアルタイムで高品質な音声に変換できます。
    *   **パーソナライズされた音声設定**: 各Agentごとに使用する音声モデルと話速を個別に設定でき、異なるAIにユニークな「声」を持たせることができます。
    *   **即時読み上げ**: 任意のAIメッセージバブルを右クリックメニューで「バブルを読み上げ」を選択すると、音声再生がトリガーされます。
    *   **インテリジェントなキューとキャッシュ**:
        *   長文は自動的に文ごとに分割され、「事前合成」技術（現在の文を再生中に、バックグラウンドでは次の文の合成が始まっている）を採用することで、長文の返信もスムーズに再生され、途切れ感を大幅に減少させました。
        *   合成済みの音声は自動的にキャッシュされ、同じ内容を再度読み上げる際には「瞬時再生」が可能で、APIへの再リクエストは不要です。
    *   **インタラクティブなコントロール**: 読み上げ中、AIのアバターは呼吸するような光のエフェクトを表示します。ユーザーはいつでも光るアバターをクリックして、現在の読み上げキューを即座に停止できます。
    *   **ダウンロードと使用**：[エンジンダウンロードリンク](https://modelscope.cn/models/aihobbyist/GPT-SoVITS-Inference/files)、20-40シリーズのNVIDIAカードは124バージョンを、50シリーズのNVIDIAカードは128バージョンをダウンロードしてください。`gsvi.bat`でエンジンを起動します。
    *   **モデルのダウンロード**：[モデルをダウンロード](https://www.modelscope.cn/models/aihobbyist/GPT-SoVITS_Model_Collection/files) 、モデルを`/models/v2proplus`フォルダにダウンロードしてください。
    *   **出力インターフェースの最適化**：Vchatは独自開発のストリーミング枝刈りアルゴリズムを使用して、ストリーミング出力におけるTTSレンダリングの遅延を低減し、カクつきを減らします（このアルゴリズムは音声合成速度を600%向上させ、音声入力と出力の遅延をミリ秒レベルまで低減します）。そのため、Sovits出力エンジンとの互換性が必要です。Vchatリポジトリのソースコードで提供されている改造版ファイルを使用して、元のプロジェクトのコアレンダリングプログラムコードを置き換えてください。VCPChatソースコードディレクトリ内の`sovitstest/GSVI.py`をSovitsディレクトリ内の`gsvi_server/GSVI.py`に置き換え、`sovitstest/my_infer.py`をSovitsディレクトリ内の`tools/my_infer.py`に置き換えてください。
    *   **業界初のバイリンガル混合読み上げエンジン**:
        *   VChatは、強力な正規表現ベースのテキストスライシングアルゴリズムを実装し、**シームレスな日中、英中などの多言語混合読み上げ**を実現しました。
        *   **使用方法**: Agent設定で、「主言語モデル」と「副言語モデル」をそれぞれ設定し、それらに異なる正規表現を指定できます。
        *   **応用シーン**: 例えば、日本語モデルを主言語、英語モデルを副言語に設定し、副言語に`\[(.*?)\]`という正規表現を設定します。そうすると、AIが`こんにちは、[[Hello]]、今日はいい天気ですね`と話した場合、クライアントは自動的に「こんにちは、今日はいい天気ですね」を日本語モデルで、「Hello」を英語モデルで読み上げます。このプロセスは流暢で自然であり、真の「AIが外国語を教えてくれる」シーンを実現します。
## 技術スタック

*   **Electron**: クロスプラットフォームのデスクトップアプリケーションを構築するために使用。
*   **Node.js**: バックエンドの実行環境として。
*   **HTML, CSS, JavaScript**: ユーザーインターフェースの構築。
*   **コア依存ライブラリ**:
    *   `fs-extra`: 強化されたファイルシステム操作のため。
    *   `marked`: Markdownの解析とレンダリングのため。
    *   `ws`: WebSocket通信のため (VCPLog)。
    *   `pdf-parse`: PDFファイルの内容を解析してテキストを抽出するため。
    *   `mammoth`: DOCXファイルの内容を解析してテキストを抽出するため。
    *   `glob` & `minimatch`: ファイルシステムでのパターンマッチングをサポートするため（分散プラグインで使用）。
    *   `node-schedule`: タスクスケジューリングのため（分散プラグインで使用）。
*   **Pythonオーディオエンジン依存ライブラリ**:
    *   `flask` & `flask_cors` & `flask_socketio`: Webサービスフレームワークを提供。
    *   `soundfile` & `sounddevice`: コアとなる音声処理と再生ライブラリ。
    *   `numpy`: 高性能な科学計算と音声データ処理のため。
    *   `pydub`: 高度な音声操作のため。
    *   `gevent` & `gevent-websocket`: 非同期ネットワークサポートを提供。
*   **フロントエンド機能サポート**:
    *   `highlight.js`: コードブロックの構文ハイライトのため（CDNまたはローカル統合経由）。
    *   `KaTeX`: LaTeX数学公式のレンダリングのため（CDNまたはローカル統合経由）。
    *   `Pyodide`: WebAssemblyを介してクライアントサイドでPythonコードを実行するため（CDN経由でロード）。
    *   `three.js`: クライアントサイドで3Dコンテンツをレンダリングし、インタラクションするため（CDN経由でロード）。

## スクリーンショット例

以下はクライアントインターフェースのスクリーンショット例です：

![サンプル画像1](assets/E1.jpg)![サンプル画像2](assets/E2.jpg)![サンプル画像3](assets/E3.jpg)![サンプル画像4](assets/E4.jpg)![サンプル画像5](assets/E6.jpg)![サンプル画像6](assets/E5.jpg)![サンプル画像7](assets/E7.png)
![サンプル画像10](assets/E10.png)
![サンプル画像11](assets/E11.jpg)

## クライアントの責務

このクライアントは、主にVCP-AIとのチャットのためのユーザーインターフェース、ウィンドウレンダリング、Agent管理、ノート管理、ローカルデータストレージ、およびVCPサーバーとVCPLogサービスとの通信を提供する責任を負います。これは、バックエンドの強力なAI能力に豊富なインタラクションと可視化能力を提供するインテリジェントなレンダリング端末であり、ほとんどのコアAI処理ロジックとツール実行は、接続されたVCPサーバーによって実現されます。

---

## オープンソースライセンスと免責事項

### ライセンス契約

この作品は、**クリエイティブ・コモンズ 表示-非営利-継承 4.0 国際 (CC BY-NC-SA 4.0)** ライセンスの下で提供されます。

<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="クリエイティブ・コモンズ・ライセンス" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>

これは、以下の条件に従う限り、自由にこの作品を共有し、改変できることを意味します：
*   **表示 (Attribution)** — あなたは適切なクレジットを表示し、ライセンスへのリンクを提供し、元の作品に改変が加えられたかどうかの表示をしなければなりません。
*   **非営利 (NonCommercial)** — あなたはこの作品を商業目的で使用してはなりません。
*   **継承 (ShareAlike)** — もしあなたがこの作品をリミックス、改変、または二次創作した場合、あなたの貢献は元の作品と同じライセンスの下で配布しなければなりません。

詳細については、[クリエイティブ・コモンズのウェブサイト](http://creativecommons.org/licenses/by-nc-sa/4.0/)をご覧ください。

### 免責事項

本ソフトウェアは「現状のまま」提供され、商品性、特定目的への適合性、および非侵害の保証を含むがこれに限定されない、明示的または黙示的な一切の保証を伴いません。

いかなる場合においても、作者または著作権者は、契約、不法行為、その他の訴訟において、本ソフトウェアの使用またはその他の取引から生じる、または関連するいかなる請求、損害、その他の責任についても責任を負わないものとします。