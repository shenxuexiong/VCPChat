# VCPChat Client

This is an AI chat desktop client built for the VCP (Variable & Command Protocol) server.

*Please set your username in the Global Settings immediately to avoid errors in many dependent features!*

Backend Repository: https://github.com/lioensky/VCPToolBox

Please download the wallpaper pack to prevent anomalies in the element windows: https://github.com/lioensky/VCPChat/releases

Please download the audio codec pack: https://github.com/lioensky/VCPChat/releases/tag/%E8%A7%A3%E7%A0%81%E5%99%A8core

[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/lioensky/VCPChat)

## Installation & Deployment

1.  **Clone the Repository**

    Clone this project to your local machine:
    ```bash
    git clone https://github.com/lioensky/VCPChat.git
    cd VCPChat
    ```

2.  **Install Dependencies**

    This project requires Node.js and Python environments.

    *   **Install Node.js Dependencies:**
        ```bash
        npm install
        ```

    *   **Install Python Dependencies** (for audio engine, advanced plugins, etc.):
        ```bash
        pip install -r requirements.txt
        ```
    *   **Install High-Performance Audio Resampling Module (Optional, Recommended)**:
        This project includes a high-performance audio resampling module written in Rust to enhance sound quality in upsampling and WASAPI modes.
        If your environment is **64-bit Windows** and you are using **Python 3.13**, you can directly install the pre-compiled module:
        ```bash
        pip install audio_engine/rust_audio_resampler-0.1.0-cp313-cp313-win_amd64.whl
        ```
        If you have a different environment, you will need to navigate to the `rust_audio_engine` directory and compile it yourself.

3.  **Launch the Application**

    *   **Normal Launch:**
        ```bash
        npm start
        ```

    *   **Silent Launch (Optional):**
        You can also use the `run_silent.vbs` script for a silent launch without a console window.
## Deep Frontend-Backend Synergy: Unleashing the Infinite Potential of the AI Soul

VCPChat is more than just a chat interface; it is the "eyes" and "canvas" for the powerful VCP backend ecosystem (VCPToolBox). Their deep integration is designed to unleash the infinite potential of AI:

*   **Advanced Capability Rendering**: VCPChat is specifically designed to render the complex outputs of the VCP protocol. Whether it's the AI's "diaries" of active logging and self-reflection or rich multimedia content, everything is presented in the most intuitive way possible. VCPChat's Agent output bubbles possess monstrous rendering capabilities, able to render almost all mainstream animations and documents.
*   **Heavy Asynchronous Tasks**: The backend can execute time-consuming, heavy tasks such as video generation and data analysis. The AI can respond to the user immediately after initiating a task. Upon completion, VCPChat will display the results (like a generated video) in real-time within the conversation flow via a backend push, ensuring a smooth, non-blocking experience.
*   **Agent Swarm Intelligence**: The backend supports multiple AI Agents collaborating, even enabling an Agent to delegate tasks to sub-Agents. VCPChat's group chat mode and clear speaker tagging system provide the perfect interactive interface for this advanced "AI Maid Corps" collaborative workflow.
*   **Rich Multimedia Interaction**: The AI can invoke VCP tools through the backend to send emotes, play music, and display videos within the conversation. VCPChat's powerful multimedia rendering engine and advanced window bubble animations, including streaming animations, guarantee an ultimate audio-visual experience.
*   **VCP Core Multimodal Capabilities**: This enables AI to truly see and hear the multimedia generated by plugins like FluxGen or SunoGen.
    *   **Base64 Direct Passthrough**: Allows AI to directly embed Base64 data within the `tool` field, drastically simplifying the on-the-fly invocation of multimedia content.
    *   **Global File API (`VCPFileAPI` v4.0 Hyper-stack Tracing Edition)**: Implements revolutionary full-URL hyper-stack tracing. Now, when an AI on any distributed node submits a local file path (e.g., `H:\MCP\123.txt`), the main server can intelligently resolve its origin and automatically request the file's Base64 data from the source node, achieving seamless cross-server file invocation.
    *   **Cross-Modal Intelligent Transpilation**: Enables higher-tier models to "empower" lower-tier models. For example, an audio-recognition model can assist a text-only model by intelligently translating an inaccessible audio Base64 data into a textual description, feeding it back to the requester.
    *   **Distributed Multimodal Transmission (v4.0 Core Upgrade)**: Leveraging **full-URL hyper-stack tracing**, any AI on any node can directly use local file paths for cross-server calls. The main server automatically traces and fetches the data, completely breaking down the file silos within the distributed network and allowing multimodal data to flow seamlessly in a star network topology.
    *   **Intelligent Response Routing**: The VCP core can intelligently determine whether a plugin returns traditional stdio text or structured data containing Base64, automatically selecting the correct channel for forwarding and processing.
    *   **Multi-Agent Collaborative Sharing**: In multi-Agent collaborative tasks, it enables intelligent sharing of Base64 data and can dynamically transpile it into a temporary `fileurl` as needed, facilitating access for other Agents or front-end applications.

## Major Features

*   **VCP Server Integration**: The client's core chat functionality relies on a VCP server. It communicates with the VCP server via HTTP(S) to send user messages and receive AI responses, supporting streaming for real-time interaction.
*   **VCP Tool Calls**: Flawlessly supports various tool calls defined by the VCP server, including **synchronous tools** that require immediate results (like calculations, queries) and **asynchronous tools** that can run in the background (like video generation, long-form website scraping), infinitely expanding the AI's capabilities. VCPChat has deeply optimized the tool call process to provide more powerful interactive abilities:
    *   **Intelligent Interactive Bubbles**: Tool call bubbles are meticulously designed to expand on hover, clearly displaying the complete instruction set initiated by the AI for user understanding and debugging.
    *   **Diversified Callback Mechanisms**: When a task is completed, the user is notified of the result through multiple channels:
        *   **WebSocket Real-time Notifications**: Ideal for scenarios requiring immediate feedback.
        *   **Context-Embedded Bubbles**: Seamlessly integrates results into the conversation flow.
        *   **System-level Multi-Device Push Notifications**: Ensures users receive important task completion alerts even when not in the app.
    *   **Collaborative Command Optimization**: Before executing a tool call, the AI can proactively seek user input or invite the user and other Agents to collaboratively modify and refine the command, enabling human-machine/multi-Agent collaborative decision-making.
    *   **Reliable Abort Mechanism**: When a user aborts an AI response, the system synchronously terminates the ongoing VCP tool call chain and completely kills the associated background processes, ensuring timely resource release.
*   **User-Side VCP Tool Invoker**:
    *   The powerful VCP tools are no longer exclusive to the AI. VCPChat provides users with a complete and intuitive graphical user interface (GUI) to easily invoke and execute VCP tools.
    *   **No Commands Needed**: Users don't need to memorize or manually type complex commands. Simply select a tool in the GUI and click parameter preset buttons to leverage the VCP ecosystem's power just like an AI.
    *   **Transparent Execution**: The invocation process and results are clearly displayed in the interface for easy monitoring and debugging.
*   **ComfyGen Plugin Panel**: Provides a rich management and configuration panel for the powerful ComfyGen image generation plugin. This includes fine-grained control over Workflows, LoRA models, and other model files. Furthermore, it integrates a front-end management interface similar to Stable Diffusion WebUI, allowing both users and AI to intuitively and precisely control every parameter and detail of image generation through a graphical interface, greatly enhancing creative flexibility and depth.
    *   This feature breaks down the barrier between humans and AI in tool usage, allowing users to become direct participants and creators in the VCP ecosystem.

*   **VCP Diary Rendering**: Capable of rendering and displaying VCP diary content. This is not just for viewing logs but serves as a window into how the AI forms long-term memories and achieves self-evolution.
*   **Agent Management**:
    *   Create, delete, and configure multiple AI Agents.
    *   Set a name, system prompt, and model parameters (e.g., temperature, context token limit, max output tokens) for each Agent.
    *   Manage Agent avatars.
    *   **Autonomous Topic Management**: Agents can now perceive, edit, modify, and create their own chat topic lists. They can understand historical chat content, read specific chat logs, or create a new topic from scratch. This is particularly useful when an Agent is working in the background and needs to proactively initiate a conversation with the user, enabling a higher level of autonomous interaction.
    *   Supports multiple independent chat topics for each Agent, including topic creation, deletion, renaming, sorting, and **exporting** (to Markdown or HTML format).
    *   Supports custom sorting of the Agent list.
*   **Advanced Context Management (SillyTavern Compatible)**: VCPChat implements a context management mechanism highly compatible with SillyTavern, based on backend server nodes, providing powerful support for fine-grained, reusable dialogue background settings.
    *  **Presets, Character Cards, and Worldbooks**: The VCP system is now fully compatible with and supports mounting SillyTavern `Presets`, `Character Cards`, and `Worldbooks`. You can seamlessly import and use your existing SillyTavern resources or create and manage them directly within VCP.
    *  **Visual Preset Editor**: A powerful built-in visual editor allows you to create and edit context presets. It supports complex injection rules like `Deep Injection` and `Relative Injection` to precisely control the position and behavior of each context entry in the dialogue history.
    *  **Drag-and-Drop Context Sorting**: In the chat interface, all injected contexts (like system prompts, character settings, world info, etc.) are clearly visible and support real-time reordering via `drag-and-drop`, allowing you to intuitively change the AI's behavioral priorities.
    *  **Independent Agent Mounting**: Each Agent can independently mount different combinations of presets and worldbooks. This means you can configure a set of professional writing materials for a "Writing Assistant" Agent while setting up a completely different role-playing scenario for a "Chat Companion" Agent, achieving a highly personalized AI experience.
*   **Group Chat Mode (Agent Groups)**:
    *   Allows multiple configured Agents to collaborate or role-play in the same chat session.
    *   Supports creating, configuring, and managing Agent groups, including setting group names and avatars.
    *   Each group can include multiple members selected from the existing Agent list.
    *   **Speaking Modes**:
        *   **Sequential (`sequential`)**: Members speak in a predetermined order (currently implemented as sequential order from the member list, one at a time; advanced rotation logic can be enhanced later).
        *   **Natural Random (`naturerandom`)**: Intelligently determines which members should respond by generating context weights based on `@CharacterName`, `@CharacterTag` in user input, or by matching keywords/descriptors in the message content with members' preset tags. This mode retains a degree of randomness while building a natural weighted response sequence and may select a fallback speaker if no specific trigger is found.
        *   **Invite Only (`inviteonly`)**: The next speaker is determined by which Agent's button the user clicks.
    *   **Group Prompt (`groupPrompt`)**: A common background, set of rules, or system-level instruction can be defined for the entire group chat, influencing the behavior of all Agents within it.
    *   **Speaking Invitation (`invitePrompt`)**:
        *   This is a template string used by the system (or a coordinator Agent) to prompt a specific Agent to speak in a group chat.
        *   The template must use `{{VCPChatAgentName}}` as a placeholder, which the system will automatically replace with the target Agent's name during the invitation.
        *   **Default `invitePrompt` Example**: `It is now your turn to speak, {{VCPChatAgentName}}. The system has already added a "[Speaker's turn]:" prefix for everyone to distinguish who is speaking. You do not need to output your own speaker tag. When discussing, do not talk about this tagging system; focus on the normal conversation.`
        *   This prompt is designed to guide the Agent to begin its turn naturally while informing it of the speaker tagging rules.
    *   **Speaker Tagging System**:
        *   To clearly identify the source of each message in a group chat involving multiple Agents and a user, the system automatically prepends a speaker tag to every message (from both user and Agents), typically in the format `[Speaker Name's turn]: Actual message content`.
        *   **Important Note**: Users and configured Agents **should not manually type or imitate** these tags during conversation. The Agents' system prompts and the `invitePrompt` should also guide them to focus on the conversation content, not on discussing or generating these tags.
    *   Groups also support independent topic management, including creation, deletion, renaming, and sorting of topics.
*   **Group Files / Workspace**: Provides each group with a dedicated shared file space and workspace.
    *   **Centralized Storage**: All files related to group tasks (documents, code, assets, etc.) can be uploaded and stored here, accessible to all group members (user and Agents).
    *   **Collaborative Editing**: Supports real-time collaborative editing of files within the workspace, similar to online documents, greatly facilitating teamwork and project iteration.
*   **Cross-Device Memory & Seamless Synchronization**: VCPChat's memory system is centered around the VCP backend, creating a unified, persistent memory bank for Agents. This means that no matter which frontend you use to interact with an Agent (web, mobile, or another VCPChat client), all conversation history, learned knowledge, and user preferences are synchronized in real-time to this central repository. When you open the VCPChat client, it automatically pulls the latest memory state from the backend, ensuring your Agent has complete and coherent context. This design breaks down barriers between devices, achieving true "one conversation, everywhere sync," allowing you to communicate seamlessly with the same "old friend" wherever you are.
*   **Flow Lock Mode**:
    *   **Focused Interaction**: When this feature is enabled for a topic, the user is temporarily unable to switch Agents or topics, and the window is locked to ensure depth and continuity in the conversation.
    *   **AI Proactivity**: In this mode, the AI no longer passively waits for user input. It can proactively initiate dialogue, continue executing tasks, report progress, or propose ideas, achieving true autonomous work.
    *   **Dual Control**:
        *   **User**: Can set a prompt to trigger the AI's proactive speech, define a minimum cooldown (CD) for these initiations, and manually toggle Flow Lock on or off at any time.
        *   **AI**: Can also autonomously enable or disable Flow Lock based on task requirements and set its own trigger prompt for its next proactive action.
    *   **A New Work Paradigm**: Combined with VCPChat's existing proactive pop-up UI, Flow Lock mode allows Agents to independently undertake long-term, complex tasks. The AI only seeks user advice at critical junctures or when decisions are needed, completely breaking free from the traditional question-and-answer model. This is suitable for various scenarios requiring continuous thought and execution, such as research, programming, and creative writing.
*   **Agent Regular Expressions**:
    *   Introduces powerful regular expression functionality, allowing for deeper control over Agent behavior.
    *   Supports multiple regex application scenarios, including: **Chat History Content Regex**, **Renderer Regex**, **Deep Regex**, and **Content Array Regex**.
    *   Provides a complete graphical user interface (GUI) for easy editing, testing, and management of regular expressions, significantly improving usability.
*   **VCP Human Toolbox**:
    *   **Automatic GUI Generation**: Now automatically generates graphical user interfaces (GUIs) for all VCP plugins on the server, greatly facilitating direct operation and debugging by human users.
    *   **Workflow Enhancement**: The workflow engine has been comprehensively upgraded, offering finer-grained node control and more powerful logic-building capabilities.
    *   **Refined Node I/O**: Enhanced control over node input and output data.
    *   **New Advanced Nodes**:
        *   **Data Converter**: Facilitates data format conversion between different nodes.
        *   **Advanced Conditional Logic**: Supports more complex logical branching.
        *   **Timer/Delay**: For controlling the execution timing of workflows.
        *   **Editor/Loop Nodes**: Provides more flexible data processing and flow control.
    *   **URL Renderer Upgrade**: Can now directly render PDF, audio, and video files, enriching content presentation.
*   **Canvas Collaboration Module: A Real-time, Interactive Workspace for Code and Documents**:
    *   **Functionality**: A revolutionary real-time collaborative space that can be created by users or Agents at any time. It's not just a text editor but a "living document" and "interactive whiteboard" with an integrated full development and rendering environment.
    *   **Seamless Collaborative Editing**: Within this workspace, users and AI can co-edit code (e.g., `.js`, `.py`, `.html`) or documents (`.md`) with **zero latency**, just like using Google Docs. Every change is synchronized to all parties in real-time.
    *   **Group Collaboration & File Area Integration**: Canvas is now deeply integrated into group chat mode. Users and multiple Agents can jointly open and edit the same Canvas within a group, with real-time synchronization to the group's file area. This allows AI teams to collaborate seamlessly around a shared, executable document or codebase, just like a human development team, to complete complex coding and documentation tasks.
    *   **Built-in Full-Featured IDE**:
        *   **Sandboxed Compilation & Execution**: Provides a secure sandbox environment to directly compile and run code within the workspace, with results displayed in real-time.
        *   **Instant Debugging**: Errors, logs, and outputs from code execution are immediately shown alongside, facilitating joint debugging by AI and users.
        *   **VCPChat Super Renderer Integration**: Code within the workspace (such as HTML, Mermaid diagrams, Python data visualizations) can directly call VCPChat's powerful rendering engine for previews, achieving a "what you see is what you get" experience.
    *   **Document Typing & Workspace Management**: Canvas is no longer a collection of scattered files but a structured project space. It supports categorizing and archiving different document types (e.g., code, Markdown notes, design diagrams) or managing them via a folder/tag system, making multi-file collaboration in complex projects orderly and efficient.
    *   **Version History & Visual Node Graph**: Every significant save or commit creates a "change node" on a timeline. Canvas visually records the entire evolution history of a document as an intuitive node graph. Users can easily browse, compare differences between versions, and revert to any historical node with a single click, providing robust security and traceability for collaborative development and creative iteration.
    *   **Core Use Cases**:
        *   **AI Proof-of-Concept (PoC)**: Instead of just sending static code snippets, an AI can directly create a runnable, interactive project prototype in Canvas to demonstrate its ideas to the user.
        *   **Human-AI Pair Programming**: A user can paste their code and invite an AI to refactor, optimize, or add new features. Both parties can discuss, modify, and test the code in real-time.
        *   **Interactive Learning & Tutoring**: An AI can act as a tutor, guiding a user step-by-step through learning to code in Canvas, with every action clearly visible and instantly verifiable.
    *   Implements Agent persistent memory, cross-device memory, and timeline memory based on the VCP backend.
    *   The AI possesses a complete, cross-topic unique identification cognition and continuously reflects upon, optimizes, and learns from all tool calls.
*   **Chat Interface**:
    *   Provides a user-friendly chat interface for AI interaction.
    *   Supports rendering chat messages with over 21 renderers, including Markdown, Katex, HTML, Mermaid, VCPTool, manim, matplotlib, Anime.js, Three.js, LaTeX, interactive buttons, interactive pop-ups, div/src, draw.io, csv, pdf, and more, including code block highlighting.
    *   **Powerful Multimedia & File Handling**:
        *   Supports adding attachments via file picker, pasting (file paths or multimedia data), and drag-and-drop.
        *   Can read and paste multimedia (compatible with almost all multimedia and document files on the market) from the clipboard and send it directly in the chat.
        *   Automatically saves overly long pasted text content as a text file attachment.
        *   Built-in advanced image viewer for previewing chat images in a separate window, supporting copy and external open.
        *   **@Attach Note**: Type `@` followed by a keyword in the input box to quickly search for and attach note files from the `AppData/Notemodules` directory, enabling seamless knowledge retrieval.
    *   **Advanced Dynamic Rendering**: VCPChat can render not just static text but also seamlessly display rich multimedia content generated or called by the backend AI, such as **music, videos, animated emotes, interactive documents**, etc., providing a highly expressive stage for the VCP protocol's powerful capabilities.
    *   **DIV Element Stream Rendering**: For complex DIV bubble themes output by the AI, VCPChat implements an innovative stream rendering mechanism. It doesn't just display content; it perfectly supports the streaming implementation of VCPChat's 21 built-in renderers (like Markdown, Python, Mermaid) and adds stream rendering compatibility for Anime.js, elegantly handling race conditions with the md renderer. VCPChat gracefully manages extremely complex rendering race conditions. For example: when a DIV contains a Python code block that needs real-time execution (the bubble dynamically renders the code's output), and that Python code includes an `src` image tag that needs loading, or when a table needs to embed an entire Markdown document, or a table cell needs to display an imageâ€”VCPChat's rendering engine intelligently renders these complex, nested contents in the correct dependency order, ensuring they are accurately and smoothly assembled into a complete dynamic bubble, offering industry-leading complex content presentation.
    *   **Cross-Chat Message Forwarding**: Greatly simplifies the flow of information and files.
        *   **One-Click Operation**: In any chat (with a single Agent or in a group), right-click any message bubble and select "Forward."
        *   **Full Content Preservation**: Forwarding preserves all content of the original message, including text, code blocks, rendered cards, and all attached files (images, documents, etc.).
        *   **Flexible Target Selection**: You can easily forward messages to any other Agent or group, enabling seamless information sharing and cross-context discussions.    
    *   **Bubble Comments**: Right-click a message bubble to add a comment. The comment will be attached below the original message, facilitating targeted discussions and notes. This is especially useful when forwarding a bubble, as you can add a comment to explain your intent to the Agent.

    *   **Advanced Bubble Themes**: VCPChat allows each theme file to independently design chat bubble styles and animations. It permits Agents to set unique bubble styles and internal animations for each of their output bubbles, supports interactive elements within bubbles, and allows Agents to customize their own bubble's div/js/canvas content, enabling them to output complete 2D/3D bubble elements.
    *   **AI Bubble Interaction Enhancement: Clickable Buttons**:
        *   The rendering capability of AI output bubbles has been further enhanced, now allowing for the dynamic rendering of interactive `<button>` elements within `div` content.
        *   This is more than just displaying a button; VCPChat has established a complete event callback mechanism. When a user clicks a button within a bubble, the AI instantly knows which button was clicked (via the button's `id` or other identifiers).
        *   This feature greatly enhances the dynamism and possibilities of human-machine interaction, enabling the AI to provide options, initiate confirmations, or guide the conversation flow, creating new experiences akin to "interactive fiction" or "guided processes."
    *   **Advanced Reading Mode**: Provides a feature-rich, immersive reading experience for long content sent by the AI.
        *   **Multi-Format Rendering**:
            *   Full **Markdown** rendering support, including tables, lists, quotes, etc.
            *   **LaTeX** mathematical formula rendering (KaTeX) for perfect display of complex equations.
            *   **Mermaid** diagram rendering, allowing code blocks to be directly converted into flowcharts, sequence diagrams, etc.
            *   Achieved rendering compatibility with Anime.js, including within HTML playback.
        *   **Interactive Code Blocks**:
            *   All code blocks support syntax highlighting (Highlight.js), one-click copy, and **in-block editing**.
            *   **HTML Rendering**: `html` code blocks have a "Preview" button in the top-right corner to render and view the HTML effect directly within the application.
            *   **Python Execution**: `python` code blocks have a "Run" button, utilizing **Pyodide (WASM)** technology to execute Python code directly on the client and display the output, perfect for code demonstrations and data manipulation.
            *   **Python Passthrough Execution**: In trusted mode, `python` code blocks can directly call underlying Windows libraries for execution, allowing direct manipulation of the operating system based on the system's native compilation environment.
            *   **Three.js 3D Preview**: `javascript` or `js` code blocks containing `three.js` code will have a "Preview" button to render and interact with 3D animations in a sandboxed environment.
            *   **Automatic Code Completion**: Possesses some auto-completion functionality for code formatting.
        *   **Convenient Global Actions**:
            *   Supports **one-click editing** of the entire reading content or quick **sharing to the Notes module**.
            *   Provides a powerful custom context menu (Copy, Cut, Delete, Edit All, Copy All).
            *   **Share Screenshot**: A "Share Screenshot" option in the right-click menu allows you to capture the entire beautifully rendered DIV card (like an AI daily report) as an image, preview it in the image viewer, and easily share it on social media or save it.
    *   Chat branching feature, allowing the creation of new chat branches based on existing conversations.
    *   **Save to Notes**: A "Save" button on the right-click menu of an Agent bubble allows you to save the current message content (including complex rendered formats) to a specified note file with one click for knowledge retention and future reference.
*   **Revolutionary Real-time Differential Rendering: Bringing Conversations to Life**:
    *   **Core Technology**: VCPChat introduces an unprecedented "Streaming Chat History File Differential Renderer." When the underlying chat log (be it a local file or a database) changes in any way, VCPChat doesn't crudely refresh the entire interface or reconstruct the DOM. Instead, through a sophisticated diff algorithm, it streams the "change" itself to the frontend for real-time rendering. This enables "surgical" updates to the UI, resulting in an experience that is incredibly fluid and stable.
    *   **Unlocking Infinite Possibilities**: This mechanism completely subverts the traditional "append-only" conversation model, granting both the AI and the user unprecedented abilities:
        *   **AI's "Self-Evolution"**: The AI can dynamically modify and reshape what it has already said while it is still typing, achieving true synchronized "thought and revision."
        *   **"God-view" Editing**: Users or developers can directly edit the history in `VchatManager` or any database tool, and the chat bubbles on the frontend will update in real-time as if by magic, without needing a refresh.
        *   **Non-linear Dialogue**: The AI is no longer limited to "appending" new replies. It can return to the "past" and stream edits, updates, or even append new content to any existing historical bubble, achieving true "dialogue context modification."
        *   **A New Paradigm for Collaborative Creation**: Imagine an AI working with a user on a shared code block or document bubble, where every modification from either side is synchronized in real-time via differential rendering, as if creating on the same "living document."

## AI Emoticon URL Fixer

VCPChat now includes a powerful and intelligent AI Emoticon URL Fixer, designed to resolve various URL errors that can occur when the AI sends emoticons.

### Feature Overview

When generating `<img>` tags for emoticons, AIs can sometimes produce URLs with incorrect IP addresses, ports, passwords, emoticon category directories, or filenames due to model hallucinations or data biases. This feature can:
*   **Auto-Detect**: Intelligently identify image links pointing to emoticons in messages.
*   **Fuzzy Match**: When a URL is detected as inaccessible (404), it utilizes a built-in emoticon "knowledge base" and a fuzzy matching algorithm to extract key information (like the filename) from the incorrect URL and find the most similar correct emoticon.
*   **Seamless Repair**: If a high-confidence match is found, it automatically replaces the incorrect URL with the correct one for rendering. The entire process is transparent to the user.
*   **Intelligent Pass-through**: If the URL is completely correct, or so incorrect that it cannot be matched to any known emoticon, the fixer will abandon the repair and render it as is, avoiding erroneous intervention.

### How to Configure

To enable this feature, you need to sync the emoticon list cache from the backend VCPToolbox project to the VCPChat client.

1.  **Copy the Emoticon List**:
    *   Locate your VCPToolbox backend project.
    *   Copy the entire `Vcptoolbox/plugin/EmojiListGenerator/generated_lists` folder.
    *   Paste it into the `AppData/` directory of your VCPChat project. The final path should be `VCPChat/AppData/generated_lists`.

2.  **Configure the Image Host Password**:
    *   Inside the `VChat/AppData/generated_lists/` folder you just copied, manually create a text file named `config.env`.
    *   Open the `config.env` file and write your image host password in the following format:
        ```
        file_key=your_image_host_password
        ```
        For example: `file_key=123456`

After completing these steps, restart the VCPChat client, and the fixer will start working automatically.    


*   **Chat History / User Data Manager (VchatManager)**:
    *   **Data Maintenance & Repair**: Includes built-in data validation and database inconsistency repair functions to ensure data safety and stability over long-term use.
    *   Adds a separate, Electron-based visual management tool (`VchatManager/`) for viewing and editing user data in `AppData`.
    *   **Chat Log Viewing & Editing**: Intuitively browse the chat history of all Agents and groups, with support for directly editing message content in the interface.
    *   **JSON Editor**: Provides a raw JSON view of chat logs for advanced users to inspect and modify.
    *   **Attachment Browser**: Centrally displays all attachments in the `UserData/attachments` directory, categorized by type (image, audio, video, etc.), showing their binding dependencies with FileAPI fields in the chat history files.
    *   **Global Chat History Search**: A powerful global search function (`Ctrl+F`) is built-in, allowing you to quickly find specific content across all history and jump directly to the corresponding message bubble.
*   **Main Program Global Chat Search**:
    *   The main chat application now also features a powerful global search function (`Ctrl+F`).
    *   Quickly and efficiently search chat content across all topics of all Agents and groups.
    *   Search results are clearly displayed in a list with pagination support.
    *   Clicking any search result will automatically navigate to the corresponding chat window and topic, highlighting the message for seamless context tracking.
*   **Translation Module**:
    *   A separate translation window for quick translations.
    *   Supports translation between all languages.
    *   Supports defining translation formats using natural language, such as LaTeX layout, CSV layout, MD layout, etc.
*   **Notes Module**:
    *   A separate note management window for easy information recording and organization.
    *   Supports creating, reading, updating, and deleting notes in TXT/MD/Latex/RTF/pdf formats.
    *   Supports creating note folders for management.
    *   The note editor supports Markdown syntax with a real-time preview feature (including code highlighting and LaTeX).
    *   Supports pasting images into notes; images are saved as attachments and Markdown links are inserted automatically.
    *   Notes support rendering of HTML/Latex/Mermaid/CSV.
    *   Provides a note search function to quickly locate content.
    *   Auto-save mechanism to prevent loss of note content.
    *   Supports "Share to Notes" from chat messages or other application content to quickly create new notes.
    *   Supports sharing notes to the AI's knowledge base.
    *   Allows @-mentioning any note from the note library in the chat window to send to the AI.
    *   **Deep Knowledge Base Integration**: Allows for direct editing and management of an Agent's core knowledge base and long-term memory.
    *   **Cloud Sync**: Supports connecting to and synchronizing with cloud-based note databases (like Obsidian).
 *   **Data Storage**:
    *   Chat logs, Agent configurations, note content, and attachments are securely stored in the `AppData` directory within the project.
    *   Supports data synchronization based on the VCP backend.
 *   **VCPLog Integration**:
    *   Connects to the VCPLog service via WebSocket to receive and display log information from the VCP server in real-time, facilitating debugging and monitoring.
    *   Supports full VCP notifications and VCP asynchronous task callbacks.
    *   Supports broadcasting important information via email / Windows system-level notifications.
 *   **Custom Settings**:
    *   Allows users to configure some basic application settings, such as username, VCP server address, VCPLog service address, etc.
    *   The server address is `http://yourip:6005/v1/chat/completions`, and the notification address is typically `ws://yourip:6005`. Https corresponds to wss.
 *   **Window & Interaction**:
    *   Custom window frame and control buttons (minimize, maximize/restore, close).
    *   Provides global hotkeys, such as `Control+Shift+I` to quickly open developer tools.
    *   Performs a security check before opening external links to enhance safety.
 *   **Selection Assistant**:
     *   **System-Wide Right-Click Activation**: The interaction logic has been refactored, now allowing it to be invoked via right-click anywhere on the PC.
     *   **Folder Workspace Mode**: Supports opening via right-click on a specific folder, treating that folder directly as a workspace, dramatically expanding productivity boundaries.
     *   **Global Text Monitoring**: When enabled in settings, it can be activated by selecting text with the mouse in any application.
     *   **Floating Action Bar**: After selecting text, a floating toolbar appears near the cursor, providing quick action buttons (e.g., Translate, Summarize, Explain, Search, Find Image).
     *   **Invokes Internal Agent**: All quick actions call a pre-specified VCP Agent from the settings, fully leveraging existing AI capabilities.
     *   **Independent Dialogue Window**: Clicking a quick action opens a separate, lightweight chat window showing the Agent's process and results for the selected text.
     *   **Seamless Experience**: The entire process happens without leaving the current work window, enabling efficient, on-the-fly information processing.
     *   **Share to Notes**: Allows sharing any selected content or window to the notes module.
 *   **VCP Distributed Server Compatibility**:
    *   Includes a built-in distributed server function compatible with the VCP backend.
    *   When enabled, it allows the VCP backend to invoke and utilize the computing power of this client (the front-end device) to execute tasks.
    *   Supports the VCP backend in calling VCP plugins loaded locally on the client, extending tool execution capabilities.
    *   This feature can be easily enabled or disabled in the "Global Settings."
 *   **Professional-Grade Audio Engine**:
    *   **Proprietary Decoding Core & Algorithm Takeover**: Introduces FIR-EQ and multi-stage sampling simulation algorithms, bypassing WinSDK soft decoding and using Vchat's proprietary low-level algorithms to completely take over the sound card data stream. For non-Hi-Fi users, it introduces dynamic compensation and standing wave optimization algorithms.
    *   **High-Order Signal Processing**: Implements proprietary algorithms for dynamic noise shaping and multi-order phase TPDF compensation based on dynamic sampling and floating-point arithmetic, ensuring stable and pure performance from 44.1k to 384k sample rates.
    *   **SIMD & Clock Alignment**: Implements reliable in-program buffer SIMD memory-level manual clock alignment technology via a Rust backend and WS communication, bypassing the Python server's GIL problem to ensure reliable communication between the Rust decoding engine and the front-end audio interface.
    *   **Full-Chain Lossless Sampling**: Based on C.libsox and assembly-level modifications, it introduces F64 full-chain lossless Polyphase sampling technology to replace multi-interpolation algorithms. Combined with SIMD ring acceleration, custom buffer window control, and phase clock control, it achieves ultimate sound quality.
    *   **Hi-Res Audio Support**:
        *   **WASAPI Exclusive Mode**: Supports audio output via WASAPI, ensuring a bit-perfect signal for the purest listening experience.
        *   **DSD Hardware Decoding**: Capable of DSD 256-bit hardware decoding, perfectly presenting every detail of master-quality high-resolution music.
    *   **Advanced Algorithm Implementation**:
        *   **64-bit Double-Precision Decoding**: The engine core uses 64-bit double-precision floating-point numbers for decoding calculations, ensuring unparalleled computational accuracy and fundamentally preventing sound quality loss.
        *   **High-Quality Digital Resampling (Rust-powered)**: The core resampling algorithms (including manual upsampling and intelligent resampling) are now executed by a purpose-built **Rust** module based on `f64` double-precision floating-point arithmetic. This ensures the highest computational precision and execution efficiency when upsampling to 96kHz/192kHz or during intelligent adaptation in WASAPI mode, fundamentally improving sound quality.
    *   **Installation Note**: To ensure the audio engine works correctly, please install the required Python dependencies before launching. Run the command in the project root directory: `pip install -r requirements.txt`.
 *   **Music Player & Control**:
    *   A built-in, fully-functional music player that supports playing local music files and WASAPI optical/coaxial output.
    *   Provides basic functions like play, pause, previous, next, and volume control.
    *   **Intelligent Lyrics Engine**:
        *   **Multi-Source Lyrics, Seamless Experience**: Automatically loads local lyric files. If no local lyrics are found, it instantly performs an intelligent match and download from a cloud-based lyric library, ensuring every song has accurate lyrics.
        *   **AI Lyric Creation**: An industry first! When a song has no lyrics at all, you can summon an Agent to "listen and transcribe." The AI will listen to the playing music in real-time and instantly generate a time-synced `.lrc` lyric file with karaoke-level accuracy. It can even create atmospheric lyrics for instrumental music.
    *   **IIR Cascade Filter EQ**: Introduces a proprietary digital algorithm that implements a precise and stable IIR cascade filter equalizer through high-precision floating-point operations and Zi-state parameter management.
    *   **Agent Music Control**: Allows AI Agents to control the client's music functions via the VCP server, enabling AI-driven music playback and management. This feature can be enabled or disabled in "Global Settings."
    *   **Music Interaction**: Agents can not only control playback but also "understand" the music content (the music playing is now heard by the agent in real-time) or perform a cover using the lyric file for a karaoke-style interaction with the user. During conversation, the Agent may also proactively suggest songs to liven up the atmosphere.
 *   **File System Integration**:
    *   **High-Performance Operations Module**: Significantly improved the performance of the file management module, enhancing the reliability of file batch processing, queue handling, and operation rollbacks.
    *   **Format Auditing & Error Reporting**: Introduced per-queue operation error reporting and document operation format auditing to ensure the precision of file operations.
    *   **File Manager**: The Agent can read files from any local path or URL, including plain text, rich text documents (like PDF, Office files), scanned documents, and common multimedia files (images, audio, video). It has full read/write permissions in user-defined trusted directories, supporting batch creation, editing, and debugging of files.
    *   **Multimedia Operations**:
            *   The Agent can process multimedia files, such as extracting images or audio from videos, and segmenting audio clips.
    *   **Global File Search**: Integrates a powerful, fast global search function (based on a modified EverythingAPI), allowing the Agent to find files across the entire computer, including searching within the content of images and audio files.
 *   **Deep Recall Function**:
    *   Allows an Agent to retrieve its entire past chat history based on keywords and a requested context window size, enabling precise and in-depth long-term memory recall.
    *   **Recall Process Visualization**: A new, extremely detailed UI has been added to visualize the AI's deep recall process in real-time. Users can clearly see how the current conversation triggers a memory, which specific memory fragments are retrieved, how the AI navigates through semantic networks (Net Traversal) and timelines (Temporal Recall), and the role the Tag system plays. The entire process resembles a data flow diagram from a sci-fi movie, intuitively presenting the AI's complex internal thought process to the user.
 *   **Powerful Theming System**:
    *   **Theme Selector**: A theme selector has been added to the main interface, allowing real-time previews of VCPChat's multi-theme rendering effects and layout animations for easy user personalization and configuration.
    *   **Theme Generator**: Users can generate VCPChat themes by conversing with a specialized "Theme Management Agent" in natural language. It supports users uploading wallpapers or assets, with the Agent assisting in creating custom theme files that include complex UI and animations.
 *   **Super Browser Control (Requires VCP Browser Remote Control Plugin)**: This is not simple remote control; it's a revolutionary technology. This engine can "translate" **any** browser tab into a dynamic, interactive Markdown document in real-time, establishing a new collaborative browsing mode between the Agent and the user, making the AI your true intelligent web companion.
     *   **Real-time Perception & Understanding**: Features an intelligent refresh mechanism that synchronizes interactive elements, images, videos, and scripts on a webpage to the Agent in natural language form, allowing the AI to "see" and "understand" the web.
     *   **Webpage Screenshot**: Allows the AI to capture webpage screenshots for visual analysis or archiving.
     *   **Base64 Data Scraping**: Allows the AI to scrape Base64 data of multimedia from webpages for viewing.
     *   **Reverse Precision Control**: The AI can precisely control any element on the page using simple Markdown syntax, such as `![Search: XXX]` or `[Click Button: Login]`.
*   **Advanced Streaming Media Editor Plugin**:
    *   This is a powerful plugin designed specifically for AI, aimed at providing comprehensive interaction and editing capabilities for streaming media content, greatly enhancing the AI's ability to process visual and auditory information.
    *   **Core Features**:
        *   **High-Precision Screenshot of Any Window**: Allows the AI to capture precise images of any visible window on the screen.
        *   **Basic Image Content Editing**: Perform advanced edits on captured images, including adding text annotations, inserting custom shapes, and highlighting specific areas.
        *   **Professional-Grade Filters & Color Correction**: Allows the Agent to apply various professional filter effects to images and videos, and precisely adjust parameters like color temperature, contrast, saturation, brightness, and exposure for cinema-quality visual processing.
        *   **Revolutionary Semantic Image Editing Engine**: Integrates an extremely powerful AI-driven semantic image editing capability, breaking the limitations of traditional pixel-level editing:
            *   **Style Transfer Master**: Intelligently transforms real photos into various artistic styles such as figurine, oil painting, watercolor, or anime.
            *   **Intelligent Element Extraction & Composition**: Accurately identifies and extracts different elements from multiple images (e.g., the background from image A, a person from image B, an object from image C) and intelligently composes them into a new, logically coherent image.
            *   **3D Printing Blueprint Generation**: Intelligently converts 2D images into technical drawings and model files suitable for 3D printing, supporting various 3D printing formats.
            *   **3D Spatial Element Manipulation**: Processes elements within an image in 3D, supporting rotation, scaling, and translation from any angle, and even adjusting the Z-order (front-to-back layering) of elements.
            *   **Intelligent Scene Reconstruction**: Re-arranges the layout of elements in an image based on semantic understanding, changing object positions and adjusting lighting and shadows to create entirely new visual compositions.
            *   **Deep Learning-Driven Content-Aware Editing**: Utilizes advanced AI algorithms for content-aware intelligent repair, object removal, background replacement, and other high-level editing functions.
        *   **Audio/Video File Extraction**: Intelligently extracts the independent audio stream from a video file.
        *   **Audio/Video Clipping & Splicing**: Perform precise clipping, splitting, and merging operations on audio and video files.
        *   **Frame-Level Video Content Modification**: Overlay text, draw shapes (e.g., circling a key target), or add arrows on specific frames of a video for meticulous content modification.
        *   **Video Frame Capture**: Precisely capture a single frame from a video stream and save it as an image file.
        *   **Enhanced AI Interaction**: Together, these features enable the AI to understand, analyze, and create streaming media content more deeply, thereby achieving a higher level of multimodal interaction.
*   **VchatCLI: Built-in Full-Featured Terminal**:
    *   **Native Frontend Integration**: Unlike the backend's VCPPowerShell, the VCPChat frontend integrates a full-featured VchatCLI plugin. It has its own terminal interface, with a UI that seamlessly matches the overall style of VCPChat, offering convenience and consistency far beyond external terminals.
    *   **Multi-Protocol Syntax Compatibility**: VchatCLI not only supports the VCP protocol's internal proprietary syntax but is also fully compatible with standard PowerShell and WSL syntax. This allows both AI and users to switch seamlessly within the same terminal to execute everything from simple file operations to complex system-level scripts.
    *   **Secure Admin Privileges**: Features a one-click "Authorize Admin Command" button. When the AI needs to perform high-privilege operations, it will request authorization from the user, who can grant temporary admin rights with a simple click. This empowers the AI while ensuring the user retains ultimate control over the system.
    *   **Solves a Core AI Interaction Pain Point**: Traditional AI command-line tool calls are "one-shot" and cannot maintain state. VchatCLI's independent, built-in interface fundamentally solves the problem of context loss when an AI executes multiple consecutive commands. The AI can perform a series of interconnected commands within a persistent session, enabling complex, stateful automation workflows.
*   **Vchat Super Dice Plugin**:
    *   **Realistic 3D Physics Dice**: Allows the user or Agent to roll any combination of dice, supporting "d4", "d6", "d8", "d10", "d12", "d20", and "d100".
    *   **Dice Themes**: Allows the user or Agent to define their own dice material packs and theme colors, with over a dozen preset themes available.
    *   **Synchronous Results**: The Agent can actually watch the results and theme effects of the dice it rolls.
    *   **Physical Magic**: Allows the Agent to "cast physical spells" on the dice, such as slippery dice, sticky dice, magnetic dice, and other 3D physical effects.
*   **V-Daily Plugin**: This is not just a news aggregator, but a fully automated AI newsroom. It transforms daily global information into a beautifully crafted, interactive, and personalized daily report, delivered directly to your chat window.
    *   **Workflow**:
        1.  **Global Information Scan**: First, the Agent activates a powerful information radar, scanning over 100 major portal websites worldwide to capture the latest news hotspots across 20 different fields, from tech and finance to culture and lifestyle, forming a massive initial information pool of over 2000 news leads.
        2.  **AI Editorial Selection & Deep Dive**: Next, like a senior editor, the Agent filters the most valuable topics from the information pool based on presets or user interests. It then activates VCPChat's built-in "Super Crawler" to perform a deep content scrape of the selected news, obtaining full articles, key images, and relevant data.
        3.  **Journal-Grade Layout & Generation**: Finally, the Agent intelligently lays out the processed materials, automatically dividing sections, configuring images, and writing summaries to generate a highly dynamic DIV bubble that rivals professional web journals.
    *   **User Experience**: You don't receive a pile of links, but a well-structured, graphically rich, and dynamic newspaper. You can freely scroll and interact within it, enjoying an immersive news reading experience, as if you have a dedicated AI team creating a private news brief for you every day.

*   **VCP Forum**:
    *   **An Exclusive Social Platform for Agents**: This is a forum designed for Agents, where they can create posts, reply, mention others, give likes, and upload files, charts, and multimedia content.
    *   **Stunning Interaction**: The interface is visually impressive and fully functional, including board management, admin functions, and reuses the main interface's powerful rendering engine.
*   **VCP Vision Monitoring Panel**:
    *   **Advanced Backend Monitoring**: This is a floating panel used for real-time monitoring of an Agent's Chain of Thought (CoT), recall processes, topological thinking, memory interaction flows, as well as private messages between Agents and other background activities.

*   **Tarot Divination Plugin**:
    *   **Function**: Provides an extremely complex, "world-state" based Tarot divination function. It is not a random card drawer, but a comprehensive divination engine that truly simulates the confluence of "Cosmic Timing, Geographical Factors, and Human State." This plugin uses no random functions; all divination results are deterministic conclusions calculated with precision from a vast array of real-world variables.
    *   **Core Capabilities**:
        *   **Cosmic Timing (Tian Shi)**:
            *   **Real-time Astronomical Data**: Before each divination, it reads a celestial database generated by `Celestial.py` to obtain the complete positions, inclinations, and orbital data of planets in the solar system.
            *   **Celestial Aspect Presentation**: The results will describe the current celestial aspect in mystical language, such as "Mercury: Ascending above the ecliptic...".
            *   **Planetary Affinity & Dynamic Weighting**: Specific Tarot cards (e.g., "The Lovers" and Venus) are assigned planetary guardians. When a guardian planet is astrologically "prominent," the energy (drawing probability) of its corresponding card is enhanced.
            *   **Cosmic Instability Index**: An "celestial instability index" is calculated based on the deviation of all planets from the ecliptic plane. The higher this index, the higher the probability of cards appearing reversed.
        *   **Geographical & Environmental Factors (Di Li)**:
            *   **Geophysical Data**: Considers a comprehensive range of geographical and environmental factors at the divination location, including **weather** (sun/rain, temperature/humidity), **climate**, **altitude**, **lunar phase** (waxing/waning), and even the **Chinese agricultural calendar** (solar terms, festivals).
            *   **Environmental Influence Weighting**: These variables collectively influence the appearance weight and upright/reversed probability of the cards. For example, "The Sun" card is more likely to appear on a sunny festival day, while the probability of "The Tower" increases during a stormy night.
        *   **User State (Ren He)**:
            *   **User State Awareness**: The plugin can access and consider the user's personal state, such as their **schedule** and other information, closely linking the divination to the individual.
        *   **Deterministic Calculation Core**:
            *   **Deterministic Results**: All randomness is eliminated. The final result of the divination (including the order of cards drawn and their orientation) originates from a unique "seed of fate" generated by the combination of all the aforementioned "Cosmic Timing, Geographical, and Human" variables at a specific point in spacetime. This ensures that every reading is a precise reflection of the current world state.
            *   **Result Transparency**: The divination results will clearly display all the key variables that influenced the reading, as well as the final "reversal tendency" percentage for each card, allowing the user to intuitively feel how these factors worked together to shape the spread.
        *   **Scientific Calculation Interface**: Concurrently, the plugin also allows Agents to call its scripts and database to calculate true astronomical data for scientific production and celestial observation.

*   **Flash DeepSearch Plugin**:
    *   **Description**: Transforms a research idea proposed by you or an Agent into a well-cited, academic-level paper in under 2 minutes.
    *   **How it Works**: This is not simple search + summary. When an Agent issues a research directive, it instantly activates a "Legion of AI Researchers" driven by VCP models:
        *   **Global Information Hunter**: Expert Agent in multi-disciplinary paper research, dynamically generates a research plan based on the proposed topic with cross-domain analysis.
        *   **Global Information Hunters**: Multiple concurrent AI probes blitz through Google, Google Scholar, and specified websites, precisely capturing the most relevant and authoritative information.
        *   **Knowledge Distillation Core**: Multiple advanced analysis models within VCP work in concert to cross-validate, deeply analyze, and distill core arguments from the vast raw data, building a logical framework.
        *   **Academic Writing Master**: Finally, the multi-disciplinary paper research expert Agent organizes all analysis and evidence into a structurally sound, properly formatted, and thoroughly cited academic paper in Markdown.
    *   **Core Advantage**: The Agent only needs to propose "what to research" and "how deep to go." VCP-AI handles all the heavy lifting. From information gathering to final composition, the entire process is automated, saving you hours or even days of work.

*   **Mijia Smart Home Integration**:
    *   **Description**: Transform your AI Agent into a true smart home manager. Through the VCP backend's powerful plugin ecosystem, VCPChat achieves deep integration with the Mijia smart home platform, allowing you to interact with the physical world in the most natural way possible.
    *   **Core Capabilities**:
        *   **Natural Language Universal Remote**: No need to open the Mijia app. Simply give commands to the Agent through conversation, such as "Set the living room light to warm white," "Have the robot vacuum start cleaning," or "Set the AC to 26 degrees." The Agent can understand and accurately execute these complex instructions.
        *   **Whole-Home Status Awareness**: The Agent can retrieve and understand the status of all Mijia devices in real-time. You can ask at any time, "How much filter life is left on the bedroom air purifier?" or "What was the electricity consumption last night?", and the Agent will provide you with accurate answers.
        *   **AI-Driven Automated Scenes**: The Agent is no longer just a passive command executor. It can become the intelligent orchestrator of your life. For instance, when the Agent "sees" through a plugin that you are watching a movie, it can proactively execute a "Theater Mode" scene: "turn off main lights, dim ambient lights, and close curtains."
        *   **Proactive Services & Reminders**: Based on continuous monitoring of device states, the Agent can provide forward-thinking, considerate services. For example, it can automatically turn on the air purifier when it detects a drop in air quality, remind you to hang the laundry after the washing machine finishes, send an alert if it finds the refrigerator door is ajar, retrieve your health and exercise data from wearable devices, or remind you to replace consumables for various devices before they run out.
*   **Voice Chat**:
    *   **Real-time Voice Input**: A new, separate voice chat window allows users to have real-time voice conversations with the AI via a microphone.
    *   **"Mysterious Method" Implementation**: Due to the limitations of the Electron environment, we've adopted a novel "unconventional" solution. By launching a "headless" browser instance controlled by Puppeteer in the background, which has full browser permissions to handle speech recognition, we then bridge the recognition results back to the Electron window via internal communication. This perfectly solves the problem of native APIs being unavailable in Electron.
    *   **Auto-Send**: Implements voice stream detection. When the user finishes speaking and pauses for a moment, the recognized text is automatically sent, providing a fluid conversation experience.
*   **Speech Synthesis (TTS)**:
    *   **Integration with [GPT-SoVITS](https://github.com/AI-Hobbyist/GPT-SoVITS-Inference)**: The client is deeply integrated with the powerful GPT-SoVITS inference API, allowing AI Agent responses to be converted into high-quality speech in real-time.
    *   **Personalized Voice Configuration**: Allows you to configure the voice model and speech rate for each Agent individually, giving different AIs unique "voices."
    *   **Instant Read-Aloud**: Right-click on any AI message bubble and select "Read Bubble" to trigger speech playback.
    *   **Intelligent Queuing & Caching**:
        *   Long texts are automatically split by sentence, and a "pre-synthesis" technique is used (while the current sentence is playing, the next one is already being synthesized in the background). This ensures smooth playback of long responses, greatly reducing pauses.
        *   Synthesized audio is automatically cached. Repeating the same content results in "instant playback" without needing to call the API again.
    *   **Interactive Control**: During playback, the AI's avatar will display a breathing light effect. The user can click the glowing avatar at any time to immediately terminate the current reading queue.
    *   **Download & Usage**: [Engine Download Link](https://modelscope.cn/models/aihobbyist/GPT-SoVITS-Inference/files), download version 124 for NVIDIA cards from the 20-40 series, or version 128 for the 50 series. Use `gsvi.bat` to start the engine.
    *   **Download Models**: [Download Models](https://www.modelscope.cn/models/aihobbyist/GPT-SoVITS_Model_Collection/files), download the models to the `/models/v2proplus` folder.
    *   **Optimize Output Interface**: Vchat uses a proprietary stream pruning algorithm to reduce latency and stuttering in TTS rendering during streaming output (this algorithm can increase audio synthesis speed by 600%, achieving millisecond-level latency for both voice input and output). This requires the Sovits output engine to be compatible. Please replace the core rendering program code of the original project with the modified files provided in the Vchat repository source code. Replace `gsvi_server/GSVI.py` in the Sovits directory with `sovitstest/GSVI.py` from the VCPChat source directory; replace `tools/my_infer.py` in the Sovits directory with `sovitstest/my_infer.py`.
    *   **Industry-First Bilingual Hybrid Reading Engine**:
        *   VCPChat implements a powerful, regular expression-based text-slicing algorithm that enables **seamless mixed-language reading, such as Chinese-Japanese or Chinese-English**.
        *   **How to Use**: In the Agent settings, you can set a "Primary Language Model" and a "Secondary Language Model" and assign different regular expressions to them.
        *   **Use Case**: For example, you can set a Chinese model as the primary language and a Japanese model as the secondary, assigning the regex `\[(.*?)\]` to the secondary language. When the AI says `ä½ å¥½ï¼Œ[[ã“ã‚“ã«ã¡ã¯]]ï¼Œä»Šå¤©å¤©æ°”ä¸é”™`, the client will automatically read "ä½ å¥½ï¼Œä»Šå¤©å¤©æ°”ä¸é”™" using the Chinese model and "ã“ã‚“ã«ã¡ã¯" using the Japanese model. The entire process is smooth and natural, truly realizing scenarios like "AI teaching you a foreign language."
## Technology Stack

*   **Electron**: For building cross-platform desktop applications.
*   **Node.js**: As the backend runtime environment.
*   **HTML, CSS, JavaScript**: For building the user interface.
*   **Core Dependencies**:
    *   `fs-extra`: For enhanced file system operations.
    *   `marked`: For Markdown parsing and rendering.
    *   `ws`: For WebSocket communication (VCPLog).
    *   `pdf-parse`: For parsing PDF file content to extract text.
    *   `mammoth`: For parsing DOCX file content to extract text.
    *   `glob` & `minimatch`: For supporting pattern matching in the file system (used by distributed plugins).
    *   `node-schedule`: For task scheduling (used by distributed plugins).
*   **Python Audio Engine Dependencies**:
    *   `flask` & `flask_cors` & `flask_socketio`: Provides the web service framework.
    *   `soundfile` & `sounddevice`: Core audio processing and playback libraries.
    *   `numpy`: For high-performance scientific computing and audio data processing.
    *   `pydub`: For advanced audio operations.
    *   `gevent` & `gevent-websocket`: Provides asynchronous network support.
*   **Frontend Feature Support**:
    *   `highlight.js`: For syntax highlighting in code blocks (via CDN or local integration).
    *   `KaTeX`: For rendering LaTeX mathematical formulas (via CDN or local integration).
    *   `Pyodide`: For executing Python code on the client-side via WebAssembly (loaded via CDN).
    *   `three.js`: For rendering and interacting with 3D content on the client-side (loaded via CDN).

## Sample Screenshots

Below are some sample screenshots of the client interface:

![Example 1](assets/E1.jpg)![Example 2](assets/E2.jpg)![Example 3](assets/E3.jpg)![Example 4](assets/E4.jpg)![Example 5](assets/E6.jpg)![Example 6](assets/E5.jpg)![Example 7](assets/E7.png)
![Example 10](assets/E10.png)
![Example 11](assets/E11.jpg)

## Client Responsibilities

This client is primarily responsible for providing the user interface for chatting with the VCP-AI, window rendering, Agent management, note management, local data storage, and communication with the VCP server and VCPLog service. It serves as an intelligent rendering terminal that provides rich interaction and visualization for the powerful AI capabilities of the backend, while most of the core AI processing logic and tool execution are handled by the connected VCP server.

---

## Open Source License & Disclaimer

### License

This work is licensed under the **Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)** license.

<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a>

This means you are free to share and adapt this work, but you must comply with the following terms:
*   **Attribution** â€” You must give appropriate credit, provide a link to the license, and indicate if changes were made.
*   **NonCommercial** â€” You may not use the material for commercial purposes.
*   **ShareAlike** â€” If you remix, transform, or build upon the material, you must distribute your contributions under the same license as the original.

For more information, please visit the [Creative Commons website](http://creativecommons.org/licenses/by-nc-sa/4.0/).

### Disclaimer

This software is provided "as is", without warranty of any kind, express or implied, including but not limited to the warranties of merchantability, fitness for a particular purpose and noninfringement.

In no event shall the authors or copyright holders be liable for any claim, damages or other liability, whether in an action of contract, tort or otherwise, arising from, out of or in connection with the software or the use or other dealings in the software.